import{_ as n,c as l,o as e,a4 as a,j as s,a as i}from"./chunks/framework.uKVmtqZI.js";const t="/assets/%E7%A1%AC%E4%BB%B6%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83%E4%BF%A1%E6%81%AF.DlY-ee0c.png",p="/assets/%E5%AE%9A%E4%BD%8D%E6%95%B0%E6%8D%AE%E6%8E%A5%E5%85%A5%E6%B5%81%E7%A8%8B.C9LivSEs.png",h="/assets/%E4%BA%8B%E4%BB%B6%E8%AE%A2%E9%98%85%E5%85%A5%E5%BA%93%E6%97%B6%E5%BA%8F.CyZLjzpX.png",k="/assets/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E9%80%9A%E7%94%A8%E6%B5%81%E7%A8%8B.CmU8Y050.png",r="/assets/%E5%8E%9F%E5%A7%8B%E5%AE%9A%E4%BD%8D%E6%95%B0%E6%8D%AE%E8%A1%A8%E7%BB%93%E6%9E%84.C2iozb_o.png",d="/assets/%E5%8E%9F%E5%A7%8B%E5%AE%9A%E4%BD%8D%E6%95%B0%E6%8D%AE%E8%A1%A8%E5%88%86%E5%8C%BA%E7%BB%93%E6%9E%84.uEVv7ZOQ.png",m="/assets/sql%E7%BB%9F%E8%AE%A1%E5%88%86%E6%9E%90%E8%A1%A8%E5%88%86%E5%8C%BA%E5%8D%A0%E7%94%A8%E5%AD%98%E5%82%A8.CT2ty_av.png",c="/assets/sql%E7%BB%9F%E8%AE%A1%E8%A1%A8%E5%88%86%E5%8C%BA%E6%95%B0%E6%8D%AE%E9%87%8F.DkdjZDwP.png",o="/assets/sql%E7%BB%9F%E8%AE%A1%E5%88%86%E5%8C%BA%E5%8D%95%E6%9D%A1%E8%A1%A8%E6%95%B0%E6%8D%AE%E5%8D%A0%E7%94%A8%E7%A9%BA%E9%97%B4.C8KiJobd.png",O=JSON.parse('{"title":"并发数及数据存储性能评估","description":"","frontmatter":{"head":[["link",{"rel":"stylesheet","href":"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"}]]},"headers":[],"relativePath":"工作点滴积累/数据统计分析方法探索系列/并发数及数据存储性能评估.md","filePath":"工作点滴积累/数据统计分析方法探索系列/并发数及数据存储性能评估.md"}'),E={name:"工作点滴积累/数据统计分析方法探索系列/并发数及数据存储性能评估.md"},g=a('<h1 id="并发数及数据存储性能评估" tabindex="-1">并发数及数据存储性能评估 <a class="header-anchor" href="#并发数及数据存储性能评估" aria-label="Permalink to &quot;并发数及数据存储性能评估&quot;">​</a></h1><h2 id="项目背景" tabindex="-1">项目背景 <a class="header-anchor" href="#项目背景" aria-label="Permalink to &quot;项目背景&quot;">​</a></h2><p>空间位置融合应用<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>接收人、车、船、物等对象的各种位置数据，通过拟合纠偏算法进行时空融合统一解算，解算出人、车、船、物等对象的准确位置，结合地图提供目标实时位置展示、锁定追踪、移动路线查询等功能。</p><p>我负责其中原始定位设备接入模块的设计以及开发工作，在前期设备和技术方案预研阶段，设想接入的设备类型众多，并且定位的数据量巨大。因此在设计阶段即需要充分考虑了这些问题，程序通过支持集群部署，多线程消费，应用缓存和表分区存储等技术手段来满足应用需求，其中涉及的技术实现，数据模拟/接入过程等本文只会略微带过，但是不做展开介绍，以后有缘再叙。</p><p>本文探索的重心是思考和介绍在高并发、大容量存储场景中，如何去统计分析相关的并发数量，处理耗时以及存储容量等性能参数，通过精确的数值来充分评估程序的性能参数，还有可能存在的安全隐患和规避策略。</p><h2 id="准备工作" tabindex="-1">准备工作 <a class="header-anchor" href="#准备工作" aria-label="Permalink to &quot;准备工作&quot;">​</a></h2><h3 id="基础工具" tabindex="-1">基础工具 <a class="header-anchor" href="#基础工具" aria-label="Permalink to &quot;基础工具&quot;">​</a></h3><p>在数据统计分析过程中，除了安装完平台以外，还需要用到一些数据库和MQ的连接工具以及基础的统一技术架构的解密工具，其中关于如何连接使用工具将不做赘述。</p><ul><li>数据库连接工具：DBeaver</li><li>SSH终端工具：MobaXterm</li></ul><h3 id="平台信息" tabindex="-1">平台信息 <a class="header-anchor" href="#平台信息" aria-label="Permalink to &quot;平台信息&quot;">​</a></h3><p>基础平台的构架版本以及涉及到数据接入的核心组件的版本等信息，基于“域见”构架（isecure），V2.2.4版本的<strong>iSecure Center-Port（港口数字化管理平台）V2.1.0 产品</strong>为基础测试平台。</p><ul><li>域见构架 <sup>isecure</sup> V2.2.4.20230630112137</li><li>事件转发联动服务 <sup>ESC</sup> V2.6.1.20230621112358</li><li>设备接入框架 <sup>DAC</sup> V1.16.100.20230620171622</li><li>智能接入组件 <sup>IAC</sup> V1.16.100.20230620071957</li><li>空间位置融合应用 <sup>SLF</sup> V1.0.0.20240730114405</li></ul><h3 id="测试环境信息" tabindex="-1">测试环境信息 <a class="header-anchor" href="#测试环境信息" aria-label="Permalink to &quot;测试环境信息&quot;">​</a></h3><p>本次测试部署了两台虚拟机服务器，分别是10.67.187.248和10.67.187.245。</p><p><img src="'+t+`" alt="image-20240730143113558"></p><blockquote><p><strong>📌 备注</strong></p><p>两台虚拟机配置基本一样，因此接下来都以10.67.187.245进行参数说明以及测试验证，理论上248的参数及性能几乎无异。</p></blockquote><p>10.67.187.245服务器的CPU以及内存配置信息大致如下：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@HikvisionOS /]# lscpu ⏎</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Architecture:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          x86_64</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CPU</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> op-mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        32-bit,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 64-bit</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Byte</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Order:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            Little</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Endian</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CPU(s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):                24</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">On-line</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CPU</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">list:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   0-23</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Thread(s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) per core:    1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Core(s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) per socket:    12</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Socket(s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):             2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NUMA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Vendor</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ID:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             GenuineIntel</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CPU</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> family:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            6</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Model:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                 94</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Model</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            Intel</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Core</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Processor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Skylake)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Stepping:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">              3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CPU</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MHz:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">               2199.998</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">BogoMIPS:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">              4399.99</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Virtualization:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        VT-x</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Hypervisor</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vendor:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     KVM</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Virtualization</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> type:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   full</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">L1d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cache:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             32K</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">L1i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cache:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             32K</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">L2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cache:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              4096K</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NUMA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CPU</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     0-23</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Flags:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                 fpu</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vme</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> de</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pse</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tsc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> msr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pae</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mce</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cx8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mtrr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pge</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mca</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cmov</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pse36</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clflush</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fxsr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sse</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sse2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ss</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ht</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> syscall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pdpe1gb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rdtscp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> constant_tsc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rep_good</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nopl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> eagerfpu</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pni</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pclmulqdq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vmx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ssse3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fma</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cx16</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pcid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sse4_1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sse4_2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> x2apic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> movbe</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> popcnt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tsc_deadline_timer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xsave</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> avx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> f16c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rdrand</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hypervisor</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lahf_lm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> abm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 3dnowprefetch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> invpcid_single</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tpr_shadow</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vnmi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> flexpriority</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ept</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vpid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fsgsbase</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tsc_adjust</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bmi1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> avx2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> smep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bmi2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> erms</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> invpcid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rtm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mpx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> avx512f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> avx512dq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rdseed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> adx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> smap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clflushopt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> avx512cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> avx512bw</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> avx512vl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xsaveopt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xsavec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xgetbv1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pku</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ospke</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@HikvisionOS /]# free -h ⏎</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">              total</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        used</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        free</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      shared</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  buff/cache</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   available</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Mem:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            62G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        3.8G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         49G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         33M</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        9.4G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         58G</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Swap:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            0B</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          0B</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          0B</span></span></code></pre></div><p>从以上信息基本可以得到以下几点硬件配置信息：</p><ul><li>这是一台通过KVM<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>技术虚出来的虚拟机；</li><li>CPU频率约为2G赫兹；</li><li>逻辑CPU线程数量为24个（虚拟CPU的处理性能相较于物理机会差一些）；</li><li>服务内存约为62GB；</li></ul><h2 id="定位服务设计原理" tabindex="-1">定位服务设计原理 <a class="header-anchor" href="#定位服务设计原理" aria-label="Permalink to &quot;定位服务设计原理&quot;">​</a></h2><h3 id="总体框架" tabindex="-1">总体框架 <a class="header-anchor" href="#总体框架" aria-label="Permalink to &quot;总体框架&quot;">​</a></h3><p>首先大致介绍一下整体数据接入框架，下图罗列出了涉及的主要组件服务。</p><p><img src="`+p+'" alt=""></p><p>平台通过SDMC组件增删改管理设备信息，添加的设备会将对应的设备信息，事件类型，能力集，数据目标以及数据管道等信息下发给DAC设备接入框架和IAC智能接入框架（统称“接入框架”）。</p><p>接入框架根据设备的配置信息，加载对应的驱动用于连接设备以及接入事件数据，之后解析事件数据为事件报文转发给对应的数据目标。其中DAC约定的事件上报数据目标为RabbitMQ，默认交换机为：<code>dem.demqueue.queue.device_event</code>；IAC约定事件上报数据目标为RabbitMQ，默认交换机为：<code>dem.demqueue.queue.intelligent_event </code>。</p><h3 id="数据接入流程" tabindex="-1">数据接入流程 <a class="header-anchor" href="#数据接入流程" aria-label="Permalink to &quot;数据接入流程&quot;">​</a></h3><p>接上文接入框架将事件推送到数据目标RabbitMQ中之后，ESC事件服务消费数据目标中的设备事件，并且根据订阅逻辑进行消息分发。</p><p>定位接入服务初始化安装首次启动后，默认会向ESC下发定位事件订阅，订阅的交换机为：<code>uls.uls_data_entry.esc_event</code>。之后即可接收到ESC分发的目标类型事件，然后存储到PostgreSQL数据库中（注：存储方式预留了轻量化存储和大数据存储两种）。</p><p><img src="'+h+`" alt=""></p><h3 id="多线程消费" tabindex="-1">多线程消费 <a class="header-anchor" href="#多线程消费" aria-label="Permalink to &quot;多线程消费&quot;">​</a></h3><p>定位接入服务中通过RabbitMQ消息中间件接入事件，在程序中即通过<a href="https://spring.io/projects/spring-amqp" target="_blank" rel="noreferrer">Spring AMQP</a>的<code>@RabbitListener</code>注解实现数据消费。</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 通用ESC订阅事件消费</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> msg</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RabbitListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> QUEUE, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bindings</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">QueueBinding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Queue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> QUEUE, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">durable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;true&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		exchange</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Exchange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Constants.ESC_EVENT_SUBSCRIPTION_EXCHANGE, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ExchangeTypes.FANOUT)),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		messageConverter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;myJackson2JsonMessageConverter&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">concurrency</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;\${slf-data-entry.rabbitmq.listener.concurrency.esc-location-event:5}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> event</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(RawEventMessageDTO msg) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isDebugEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;RawEventMessageDTO:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, JSONUtil.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toJsonStr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(msg));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	/*&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;仅作为参考，此处省略若干其余代码&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;*/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>定位消息特别多，一个消费者吭哧吭哧的消费太慢，但是我们的机器性能又杠杠的，这个时候我就希望能够并行消费，相当于同时有多个消费者来处理数据，此时通过设置<code>concurrency</code>参数即可。另外为了满足程序在集群部署场景中的数据消费需求，不发生重复消费或者漏消费等情况，需要保证<code>@Queue</code>的<code>value</code>值保持一致。</p><p>这时候肯定有小伙伴会有疑惑：这个并行线程数设置多少比较合理呢？稍安勿躁，之后的章节会有答案。</p><blockquote><p><strong>📌 备注</strong></p><p>关于多线程消费这块，很多小伙伴习惯或者喜欢或者执着于自己在消费函数内部通过异步线程的方式实现，但是我觉得这种方式增加了代码复杂度的同时，还带来了线程管理不利引发程序奔溃的风险。既然已经有更成熟的方式，为什么不用呢？当然，这个仁者见仁，智者见智。</p></blockquote><h3 id="数据处理模板" tabindex="-1">数据处理模板 <a class="header-anchor" href="#数据处理模板" aria-label="Permalink to &quot;数据处理模板&quot;">​</a></h3><p>从<code>@RabbitListener</code>监听函数收到事件消息后，通过<code>TransactionHandle</code>接口进行统一的处理。该接口类抽象为：<code>start</code>、<code>parseMessage</code>、<code>handleMessage</code>、<code>end</code>四个接口，然后定义通用的处理模板类<code>TransactionDirector</code>规范数据处理过程。</p><p><img src="`+k+`" alt=""></p><p>具体业务数据消费实现接口和注入模板即可实现统一的数据消费处理过程，这样一来的好处是规范了消息处理流程的同时，还可以在<code>end</code>函数中统一进行打印耗时，事件报文等操作。</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 结束执行，计算耗时</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> startTime</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 一次处理流程耗费的时长</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Date startTime, List</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LocationDTO</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rMessage) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isDebugEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Message time：{} milliseconds&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, DateUtil.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">between</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(startTime, DateUtil.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), DateUnit.MS));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Message Str : </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, JSONUtil.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">formatJsonStr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(transactionHandleHelp.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parseStr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rMessage)));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>千万别忽略了此处的日志打印，对于之后的问题排查以及消费性能评估起到了至关重要的作用。</p><blockquote><p><strong>📌 知识小拓展</strong></p><p>此处隐藏了一个编码的小技巧：通过<code>if (log.isDebugEnabled())</code>判断，可规避掉没有必要的DEBUG操作耗时，在一定程度上提高了程序性能。比如上文示例代码中<code>log.debug</code>打印中的<code>JSONUtil.formatJsonStr</code>日志转换操作其实都会有一定的运行耗时。</p></blockquote><h3 id="定位数据表" tabindex="-1">定位数据表 <a class="header-anchor" href="#定位数据表" aria-label="Permalink to &quot;定位数据表&quot;">​</a></h3><p>经过解析处理之后得到统一的内部私有协议数据对象表<code>source_location_current</code>进行结构化PostgreSQL数据存储。为了提高存取效率，本次设计支持PostgreSQL按天进行分区方式进行分表存储。</p><p><img src="`+r+`" alt=""></p><p>PostgreSQL的分表存储，采用内置的分区表PARTITION机制（PostgreSQL10开始支持）。PostgreSQL11可实现3种表分区：范围分区（RANGE），列表分区（LIST ）和哈希分区（HASH）。基于定位数据的特征，使用范围分区机制按天对数据进行分区存储。</p><p>基本的语法参考，以及分区形式存储的定位数据示例如下：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 创建主表，通过RANGE分区</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> measurement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    city_id         </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    logdate         </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    peaktemp        </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    unitsales       </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> RANGE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (logdate);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 创建分区表1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> measurement_y2006m02</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PARTITION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OF measurement</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FOR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VALUES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2006-02-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2006-03-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 创建分区表2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> measurement_y2006m03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PARTITION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OF measurement</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FOR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VALUES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2006-03-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2006-04-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p><img src="`+d+`" alt=""></p><h2 id="事件接入性能评估" tabindex="-1">事件接入性能评估 <a class="header-anchor" href="#事件接入性能评估" aria-label="Permalink to &quot;事件接入性能评估&quot;">​</a></h2><p>本文展示的测试数据主要来源于阡陌路上的一台匿名雷视设备，日平均数据量三百万左右。</p><p>待组件运行正常，且保证平台能够正确接入模拟数据后，即开始测试以及评估服务的并发数和存储性能。</p><h3 id="消费性能估算" tabindex="-1">消费性能估算 <a class="header-anchor" href="#消费性能估算" aria-label="Permalink to &quot;消费性能估算&quot;">​</a></h3><p>结合”<a href="#数据处理模板">数据处理模板</a>“章节预留的日志打印，通过<code>tail</code>指令打印日志（可结合<code>grep</code>过滤目标日志），取若干时刻打印数据消费的DEBUG日志（以下日志仅提取关键信息，剔除若干）用以分析事件消费基本耗时。</p><blockquote><p><strong>📌 备注</strong></p><p>需要运管修改组件日志打印等级为&quot;TRACE及以上&quot;，或者通过修改<code>logback.xml</code>增加<code>logger</code>日志打印方式。切记调试完毕还原修改，否则大量的事件报文打印存在安全隐患。</p></blockquote><p>2024-07-30 13:57左右实际耗时日志打印如下：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@HikvisionOS slf-data-entry]# tail -f slf.slf-data-entry.debug.log </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;Message time&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ⏎</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:45.669+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：8 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:45.672+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：11 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:45.948+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：8 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:46.160+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：27 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:46.400+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：15 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:46.499+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：12 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:46.537+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:46.752+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：14 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:46.798+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：8 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:47.060+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：7 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:47.095+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：7 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:47.156+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：10 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:47.301+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：9 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:47.456+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：19 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:47.655+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：7 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:47.707+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：10 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:47.718+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：14 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:47.956+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：8 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:48.026+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：12 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:48.273+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：12 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:48.366+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:48.426+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：11 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:48.619+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：8 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:48.724+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：7 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:48.958+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:49.010+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:49.067+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：8 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:49.324+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：9 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:49.435+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：13 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:49.686+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：9 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:49.732+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：9 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:49.842+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：10 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:50.187+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：8 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:50.240+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：10 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:50.538+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：8 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:50.643+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：11 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:50.688+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：9 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:50.945+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：10 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:51.047+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：9 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:51.296+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：8 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:51.453+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：14 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:51.547+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：18 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:51.748+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：11 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:51.846+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：11 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:52.249+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：9 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:52.305+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：11 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:52.511+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：11 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:52.653+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：8 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:52.752+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：9 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:53.158+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：8 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:53.251+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：7 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:53.298+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：38 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:53.569+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：11 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T13:57:53.611+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：8 milliseconds</span></span></code></pre></div><p>2024-07-30 14:45左右实际耗时日志打印如下：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@HikvisionOS slf-data-entry]# tail -f slf.slf-data-entry.debug.log </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;Message time&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ⏎</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:39.804+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：6 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:40.001+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:40.051+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:40.300+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:40.496+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:40.643+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:40.694+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:40.798+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:41.149+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:41.251+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:41.504+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：3 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:41.508+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：6 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:41.613+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:42.013+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：6 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:42.118+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:42.219+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:42.327+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：12 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:42.424+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：8 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:42.822+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：8 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:42.869+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:43.022+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：8 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:43.124+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:43.227+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:43.476+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:43.523+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：3 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:43.780+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:43.924+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:43.939+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：7 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:44.276+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：3 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:44.278+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:44.483+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:44.638+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:44.684+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：6 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:44.986+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:45.090+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:45.285+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:45.437+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:45.439+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:45.850+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：11 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:45.902+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:46.240+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：6 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:46.301+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：9 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:46.302+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：10 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:46.698+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:46.799+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:47.011+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：20 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:47.099+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:47.154+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：6 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:47.458+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:47.602+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:47.861+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：3 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:47.907+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:47.910+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:48.264+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-1]- Message time：6 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:48.407+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-5]- Message time：4 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:48.614+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-4]- Message time：6 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:48.677+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-3]- Message time：5 milliseconds</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2024-07-30T14:45:48.819+08:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEBUG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [slf.slf_data_entry_queue.esc.location_event-2]- Message time：4 milliseconds</span></span></code></pre></div><p>从以上日志可以大概评估一条事件报文的消费耗时约为10毫秒左右，并且可以明显看出程序默认启动了<strong>5个消费线程</strong>进行并行消费（<em>注：印证了”<a href="#多线程消费">多线程消费</a>“章节的多线程配置</em>）。</p><p>除此以外，抽取了两千条数据进行统计分析（<em>详见“messageTime2024-07-30_1411.csv”样本数据</em>），得到耗时<strong>平均数值约为7.3毫秒/条</strong>，耗时<strong>众数值为5毫秒/条</strong>（<em>注：此处统计分析通过EXCEL实现，分别使用了<code>AVERAGE</code>和<code>MODE</code>函数</em>）。</p><blockquote><p><strong>💣 特别备注</strong></p><p>此日志打印只能说明数据在消费函数内部执行的耗时，原则上还存在Spring AMQP框架内部接收、解析、线程管理、成功回调等一系列操作的耗时，但是这部分耗时暂未找到方法进行精确评估，所以以下公式中于预设定默认100%的冗余量，是否足够存疑！</p></blockquote>`,63),y=s("p",null,[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",null,[s("semantics",null,[s("mrow",null,[s("mtable",null,[s("mtr",null,[s("mtd",null,[s("mrow",null,[s("mrow",null,[s("mtext",null,[s("mi",{mathvariant:"normal"},"C"),s("mi",{mathvariant:"normal"},"o"),s("mi",{mathvariant:"normal"},"u"),s("mi",{mathvariant:"normal"},"n"),s("mi",{mathvariant:"normal"},"t"),s("mi",{mathvariant:"normal"},"/"),s("mn",null,"2"),s("mn",null,"4"),s("mi",{mathvariant:"normal"},"H")])])])]),s("mtd",null,[s("mrow",null,[s("mrow"),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("mn",null,"2"),s("mn",null,"4"),s("mi",null,"H"),s("mo",null,"×"),s("mn",null,"6"),s("mn",null,"0"),s("mi",null,"M"),s("mo",null,"×"),s("mn",null,"6"),s("mn",null,"0"),s("mi",null,"S"),s("mo",null,"×"),s("mn",null,"1"),s("mn",null,"0"),s("mn",null,"0"),s("mn",null,"0"),s("mi",null,"M"),s("mi",null,"S")]),s("mrow",null,[s("mn",null,"7"),s("mi",{mathvariant:"normal"},"."),s("mn",null,"3"),s("mi",null,"M"),s("mi",null,"S"),s("mo",null,"×"),s("mn",null,"2"),s("mi",null,"R")])])])])]),s("mtr",null,[s("mtd",null,[s("mrow")])]),s("mtr",null,[s("mtd",null,[s("mrow")]),s("mtd",null,[s("mrow",null,[s("mrow"),s("mo",null,"≈"),s("mrow",null,[s("mn",null,"5"),s("mo",{separator:"true"},","),s("mn",null,"9"),s("mn",null,"1"),s("mn",null,"7"),s("mo",{separator:"true"},","),s("mn",null,"8"),s("mn",null,"0"),s("mn",null,"8")])])])])])]),s("annotation",{encoding:"application/x-tex"},"\\begin{aligned} {\\text{Count/24H}}&=\\frac{24H\\times60M\\times60S\\times1000MS}{7.3MS\\times2R}\\\\ \\\\ & \\approx{5,917,808} \\end{aligned} ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"strut",style:{height:"2.5148300000000003em"}}),s("span",{class:"strut bottom",style:{height:"4.52966em","vertical-align":"-2.01483em"}}),s("span",{class:"base displaystyle textstyle uncramped"},[s("span",{class:"mord"},[s("span",{class:"mtable"},[s("span",{class:"col-align-r"},[s("span",{class:"vlist"},[s("span",{style:{top:"-1.1545000000000003em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"text mord displaystyle textstyle uncramped"},[s("span",{class:"mord mathrm"},"C"),s("span",{class:"mord mathrm"},"o"),s("span",{class:"mord mathrm"},"u"),s("span",{class:"mord mathrm"},"n"),s("span",{class:"mord mathrm"},"t"),s("span",{class:"mord mathrm"},"/"),s("span",{class:"mord mathrm"},"2"),s("span",{class:"mord mathrm"},"4"),s("span",{class:"mord mathrm"},"H")])])])]),s("span",{style:{top:"0.4548299999999997em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"})]),s("span",{style:{top:"1.6548299999999998em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"})]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])]),s("span",{class:"col-align-l"},[s("span",{class:"vlist"},[s("span",{style:{top:"-1.1545000000000003em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"mord displaystyle textstyle uncramped"}),s("span",{class:"mrel"},"="),s("span",{class:"mord reset-textstyle displaystyle textstyle uncramped"},[s("span",{class:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist"},[s("span",{style:{top:"0.686em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle textstyle cramped"},[s("span",{class:"mord textstyle cramped"},[s("span",{class:"mord mathrm"},"7"),s("span",{class:"mord mathrm"},"."),s("span",{class:"mord mathrm"},"3"),s("span",{class:"mord mathit",style:{"margin-right":"0.10903em"}},"M"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mbin"},"×"),s("span",{class:"mord mathrm"},"2"),s("span",{class:"mord mathit",style:{"margin-right":"0.00773em"}},"R")])])]),s("span",{style:{top:"-0.22999999999999998em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle textstyle uncramped frac-line"})]),s("span",{style:{top:"-0.677em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle textstyle uncramped"},[s("span",{class:"mord textstyle uncramped"},[s("span",{class:"mord mathrm"},"2"),s("span",{class:"mord mathrm"},"4"),s("span",{class:"mord mathit",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"mbin"},"×"),s("span",{class:"mord mathrm"},"6"),s("span",{class:"mord mathrm"},"0"),s("span",{class:"mord mathit",style:{"margin-right":"0.10903em"}},"M"),s("span",{class:"mbin"},"×"),s("span",{class:"mord mathrm"},"6"),s("span",{class:"mord mathrm"},"0"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mbin"},"×"),s("span",{class:"mord mathrm"},"1"),s("span",{class:"mord mathrm"},"0"),s("span",{class:"mord mathrm"},"0"),s("span",{class:"mord mathrm"},"0"),s("span",{class:"mord mathit",style:{"margin-right":"0.10903em"}},"M"),s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S")])])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])]),s("span",{class:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])]),s("span",{style:{top:"1.654829999999999em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"mord displaystyle textstyle uncramped"}),s("span",{class:"mrel"},"≈"),s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"mord mathrm"},"5"),s("span",{class:"mpunct"},","),s("span",{class:"mord mathrm"},"9"),s("span",{class:"mord mathrm"},"1"),s("span",{class:"mord mathrm"},"7"),s("span",{class:"mpunct"},","),s("span",{class:"mord mathrm"},"8"),s("span",{class:"mord mathrm"},"0"),s("span",{class:"mord mathrm"},"8")])])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])])])])])])])])],-1),F=a('<p>根据以上统计数据即可大致评估计算出<strong>单线程24H的消费能力上限约为六百万条</strong>。</p><blockquote><p><strong>📌 备注</strong></p><p>冗余量即为了增强系统的可靠性和安全性，在平均值的基础上预留一定耗时冗余，以应对可能发生的故障、卡顿或不可估因素等问题。</p></blockquote><p>结合测试服务器24核CPU物理配置情况进行估算程序的并行线程数（<em>注：前提是服务器仅部署用于数据消费程序使用</em>），一般可用线程数为2倍CPU（<em>注：可参考“<a href="https://www.cnblogs.com/dennyzhangdd/p/6909771.html" target="_blank" rel="noreferrer">根据CPU核心数确定线程池并发线程数 </a>”科普文章</em>）。</p>',3),u=s("p",null,[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",null,[s("semantics",null,[s("mrow",null,[s("mtable",null,[s("mtr",null,[s("mtd",null,[s("mrow",null,[s("mi",null,"C"),s("mi",null,"o"),s("mi",null,"n"),s("mi",null,"c"),s("mi",null,"u"),s("mi",null,"r"),s("mi",null,"r"),s("mi",null,"e"),s("mi",null,"n"),s("mi",null,"c"),s("mi",null,"y")])]),s("mtd",null,[s("mrow",null,[s("mrow"),s("mo",null,"="),s("mn",null,"2"),s("mn",null,"4"),s("mi",null,"C"),s("mi",null,"P"),s("mi",null,"U"),s("mo",null,"×"),s("mn",null,"2"),s("mi",null,"N"),s("mo",null,"×"),s("mn",null,"0"),s("mi",{mathvariant:"normal"},"."),s("mn",null,"6")])])]),s("mtr",null,[s("mtd",null,[s("mrow")])]),s("mtr",null,[s("mtd",null,[s("mrow")]),s("mtd",null,[s("mrow",null,[s("mrow"),s("mo",null,"≈"),s("mn",null,"2"),s("mn",null,"8")])])])])]),s("annotation",{encoding:"application/x-tex"},"\\begin{aligned} Concurrency &= 24CPU\\times2N\\times0.6\\\\ \\\\ &\\approx 28 \\end{aligned} ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"strut",style:{height:"2.05em"}}),s("span",{class:"strut bottom",style:{height:"3.6000000000000005em","vertical-align":"-1.5500000000000007em"}}),s("span",{class:"base displaystyle textstyle uncramped"},[s("span",{class:"mord"},[s("span",{class:"mtable"},[s("span",{class:"col-align-r"},[s("span",{class:"vlist"},[s("span",{style:{top:"-1.2099999999999997em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"mord mathit",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit"},"c"),s("span",{class:"mord mathit"},"u"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit"},"c"),s("span",{class:"mord mathit",style:{"margin-right":"0.03588em"}},"y")])]),s("span",{style:{top:"-0.00999999999999951em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"})]),s("span",{style:{top:"1.1900000000000006em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"})]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])]),s("span",{class:"col-align-l"},[s("span",{class:"vlist"},[s("span",{style:{top:"-1.2099999999999997em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"mord displaystyle textstyle uncramped"}),s("span",{class:"mrel"},"="),s("span",{class:"mord mathrm"},"2"),s("span",{class:"mord mathrm"},"4"),s("span",{class:"mord mathit",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"mord mathit",style:{"margin-right":"0.13889em"}},"P"),s("span",{class:"mord mathit",style:{"margin-right":"0.10903em"}},"U"),s("span",{class:"mbin"},"×"),s("span",{class:"mord mathrm"},"2"),s("span",{class:"mord mathit",style:{"margin-right":"0.10903em"}},"N"),s("span",{class:"mbin"},"×"),s("span",{class:"mord mathrm"},"0"),s("span",{class:"mord mathrm"},"."),s("span",{class:"mord mathrm"},"6")])]),s("span",{style:{top:"1.1900000000000002em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"mord displaystyle textstyle uncramped"}),s("span",{class:"mrel"},"≈"),s("span",{class:"mord mathrm"},"2"),s("span",{class:"mord mathrm"},"8")])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])])])])])])])])],-1),B=s("p",null,[i("另外考虑其他程序占用问题，默认供程序可用线程数为60%，即可估算出"),s("strong",null,"安全的并发线程数为28"),i("（"),s("em",null,"注：程序在该并发数下测试验证消费平均耗时与上文5个并发数得到的计算值几乎无异"),i("）。此处也就解答了”"),s("a",{href:"#多线程消费"},"多线程消费"),i("“章节对于程序并行线程数设置的疑问。")],-1),C=s("p",null,[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",null,[s("semantics",null,[s("mrow",null,[s("mtable",null,[s("mtr",null,[s("mtd",null,[s("mrow",null,[s("mi",null,"C"),s("mi",null,"o"),s("mi",null,"u"),s("mi",null,"n"),s("mi",null,"t"),s("mi",{mathvariant:"normal"},"/"),s("mn",null,"2"),s("mn",null,"4"),s("mi",null,"H")])]),s("mtd",null,[s("mrow",null,[s("mrow"),s("mo",null,"="),s("mn",null,"5"),s("mo",{separator:"true"},","),s("mn",null,"9"),s("mn",null,"1"),s("mn",null,"7"),s("mo",{separator:"true"},","),s("mn",null,"8"),s("mn",null,"0"),s("mn",null,"8"),s("mo",null,"×"),s("mn",null,"2"),s("mn",null,"8")])])]),s("mtr",null,[s("mtd",null,[s("mrow")])]),s("mtr",null,[s("mtd",null,[s("mrow")]),s("mtd",null,[s("mrow",null,[s("mrow"),s("mo",null,"≈"),s("mn",null,"1"),s("mn",null,"6"),s("mn",null,"5"),s("mo",{separator:"true"},","),s("mn",null,"6"),s("mn",null,"9"),s("mn",null,"8"),s("mo",{separator:"true"},","),s("mn",null,"6"),s("mn",null,"2"),s("mn",null,"4")])])])])]),s("annotation",{encoding:"application/x-tex"},"\\begin{aligned} Count/24H&=5,917,808\\times28\\\\\\\\ &\\approx165,698,624 \\end{aligned} ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"strut",style:{height:"2.05em"}}),s("span",{class:"strut bottom",style:{height:"3.6000000000000005em","vertical-align":"-1.5500000000000007em"}}),s("span",{class:"base displaystyle textstyle uncramped"},[s("span",{class:"mord"},[s("span",{class:"mtable"},[s("span",{class:"col-align-r"},[s("span",{class:"vlist"},[s("span",{style:{top:"-1.2099999999999997em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"mord mathit",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit"},"u"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathrm"},"/"),s("span",{class:"mord mathrm"},"2"),s("span",{class:"mord mathrm"},"4"),s("span",{class:"mord mathit",style:{"margin-right":"0.08125em"}},"H")])]),s("span",{style:{top:"-0.00999999999999951em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"})]),s("span",{style:{top:"1.1900000000000006em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"})]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])]),s("span",{class:"col-align-l"},[s("span",{class:"vlist"},[s("span",{style:{top:"-1.2099999999999997em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"mord displaystyle textstyle uncramped"}),s("span",{class:"mrel"},"="),s("span",{class:"mord mathrm"},"5"),s("span",{class:"mpunct"},","),s("span",{class:"mord mathrm"},"9"),s("span",{class:"mord mathrm"},"1"),s("span",{class:"mord mathrm"},"7"),s("span",{class:"mpunct"},","),s("span",{class:"mord mathrm"},"8"),s("span",{class:"mord mathrm"},"0"),s("span",{class:"mord mathrm"},"8"),s("span",{class:"mbin"},"×"),s("span",{class:"mord mathrm"},"2"),s("span",{class:"mord mathrm"},"8")])]),s("span",{style:{top:"1.1900000000000002em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"mord displaystyle textstyle uncramped"}),s("span",{class:"mrel"},"≈"),s("span",{class:"mord mathrm"},"1"),s("span",{class:"mord mathrm"},"6"),s("span",{class:"mord mathrm"},"5"),s("span",{class:"mpunct"},","),s("span",{class:"mord mathrm"},"6"),s("span",{class:"mord mathrm"},"9"),s("span",{class:"mord mathrm"},"8"),s("span",{class:"mpunct"},","),s("span",{class:"mord mathrm"},"6"),s("span",{class:"mord mathrm"},"2"),s("span",{class:"mord mathrm"},"4")])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])])])])])])])])],-1),_=s("p",null,[i("通过单线程24H的消费能力以及基础硬件配置，即可大概评估计算出程序 "),s("strong",null,"一台服务器24H的理论消费能力上限约为1.6亿条"),i("。")],-1),f=s("h3",{id:"轻量化存储性能估算",tabindex:"-1"},[i("轻量化存储性能估算 "),s("a",{class:"header-anchor",href:"#轻量化存储性能估算","aria-label":'Permalink to "轻量化存储性能估算"'},"​")],-1),D=s("p",null,"定位事件表按天进行分区，所以理论上存储的时间颗粒度最小为“天”，进行统计分析时候即可以通过时间进行条件过滤以及关联查询。",-1),A=s("p",null,"为了评估表数据的存储性能，即需要计算获得单条表数据的平均存储空间，以及结合每天的数据入库数量进行乘积计算，计算公式如下。",-1),b=s("p",null,[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",null,[s("semantics",null,[s("mrow",null,[s("mi",null,"S"),s("mi",null,"t"),s("mi",null,"o"),s("mi",null,"r"),s("mi",null,"a"),s("mi",null,"g"),s("mi",null,"e"),s("mi",null,"T"),s("mi",null,"o"),s("mi",null,"t"),s("mi",null,"a"),s("mi",null,"l"),s("mo",null,"="),s("mover",{accent:"true"},[s("mrow",null,[s("mi",null,"S"),s("mi",null,"t"),s("mi",null,"o"),s("mi",null,"r"),s("mi",null,"a"),s("mi",null,"g"),s("mi",null,"e")]),s("mo",null,"¯")]),s("mo",null,"×"),s("mi",null,"C"),s("mi",null,"o"),s("mi",null,"u"),s("mi",null,"n"),s("mi",null,"t")]),s("annotation",{encoding:"application/x-tex"},"StorageTotal=\\bar{Storage} \\times Count ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"strut",style:{height:"0.8201099999999999em"}}),s("span",{class:"strut bottom",style:{height:"1.0145499999999998em","vertical-align":"-0.19444em"}}),s("span",{class:"base displaystyle textstyle uncramped"},[s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"a"),s("span",{class:"mord mathit",style:{"margin-right":"0.03588em"}},"g"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mord mathit",style:{"margin-right":"0.13889em"}},"T"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit"},"a"),s("span",{class:"mord mathit",style:{"margin-right":"0.01968em"}},"l"),s("span",{class:"mrel"},"="),s("span",{class:"mord accent"},[s("span",{class:"vlist"},[s("span",{style:{top:"0em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle cramped"},[s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"a"),s("span",{class:"mord mathit",style:{"margin-right":"0.03588em"}},"g"),s("span",{class:"mord mathit"},"e")])]),s("span",{style:{top:"-0.25233em","margin-left":"0em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"accent-body"},[s("span",null,"¯")])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])]),s("span",{class:"mbin"},"×"),s("span",{class:"mord mathit",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit"},"u"),s("span",{class:"mord mathit"},"n"),s("span",{class:"mord mathit"},"t")])])])])],-1),z=s("p",null,"结合以上公式以及分区存储形式，通过测试入库的数据即可计算出单条数据存储空间值的算数平均值计算公式。",-1),v=s("p",null,[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",null,[s("semantics",null,[s("mrow",null,[s("mtable",null,[s("mtr",null,[s("mtd",null,[s("mrow",null,[s("mover",{accent:"true"},[s("mrow",null,[s("mi",null,"S"),s("mi",null,"t"),s("mi",null,"o"),s("mi",null,"r"),s("mi",null,"a"),s("mi",null,"g"),s("mi",null,"e")]),s("mo",null,"¯")])])]),s("mtd",null,[s("mrow",null,[s("mrow"),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("mo",null,"("),s("msub",null,[s("mi",null,"X"),s("mn",null,"1")]),s("mo",null,"+"),s("msub",null,[s("mi",null,"X"),s("mn",null,"2")]),s("mo",null,"+"),s("mi",{mathvariant:"normal"},"."),s("mi",{mathvariant:"normal"},"."),s("mi",{mathvariant:"normal"},"."),s("mo",null,"+"),s("msub",null,[s("mi",null,"X"),s("mi",null,"n")]),s("mo",null,")")]),s("mrow",null,[s("mi",null,"n")])])])])]),s("mtr",null,[s("mtd",null,[s("mrow")])]),s("mtr",null,[s("mtd",null,[s("mrow")]),s("mtd",null,[s("mrow",null,[s("mrow"),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("msubsup",null,[s("mo",null,"∑"),s("mrow",null,[s("mi",null,"i"),s("mo",null,"="),s("mn",null,"1")]),s("mi",null,"n")]),s("msub",null,[s("mi",null,"X"),s("mi",null,"i")])]),s("mrow",null,[s("mi",null,"n")])])])])])])]),s("annotation",{encoding:"application/x-tex"},"\\begin{aligned} \\bar{Storage}&=\\frac{(X_1+X_2+...+X_n)}{n}\\\\\\\\ &=\\frac{\\sum\\limits_{i=1}^n X_i}{n} \\end{aligned} ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"strut",style:{height:"3.609033em"}}),s("span",{class:"strut bottom",style:{height:"6.718066em","vertical-align":"-3.109033em"}}),s("span",{class:"base displaystyle textstyle uncramped"},[s("span",{class:"mord"},[s("span",{class:"mtable"},[s("span",{class:"col-align-r"},[s("span",{class:"vlist"},[s("span",{style:{top:"-2.182033em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"mord accent"},[s("span",{class:"vlist"},[s("span",{style:{top:"0em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle cramped"},[s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"a"),s("span",{class:"mord mathit",style:{"margin-right":"0.03588em"}},"g"),s("span",{class:"mord mathit"},"e")])]),s("span",{style:{top:"-0.25233em","margin-left":"0em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"accent-body"},[s("span",null,"¯")])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])])])]),s("span",{style:{top:"-0.6560329999999996em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"})]),s("span",{style:{top:"2.423033em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"})]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])]),s("span",{class:"col-align-l"},[s("span",{class:"vlist"},[s("span",{style:{top:"-2.182033em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"mord displaystyle textstyle uncramped"}),s("span",{class:"mrel"},"="),s("span",{class:"mord reset-textstyle displaystyle textstyle uncramped"},[s("span",{class:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist"},[s("span",{style:{top:"0.686em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle textstyle cramped"},[s("span",{class:"mord textstyle cramped"},[s("span",{class:"mord mathit"},"n")])])]),s("span",{style:{top:"-0.22999999999999998em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle textstyle uncramped frac-line"})]),s("span",{style:{top:"-0.677em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle textstyle uncramped"},[s("span",{class:"mord textstyle uncramped"},[s("span",{class:"mopen"},"("),s("span",{class:"mord"},[s("span",{class:"mord mathit",style:{"margin-right":"0.07847em"}},"X"),s("span",{class:"vlist"},[s("span",{style:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.07847em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle scriptstyle cramped"},[s("span",{class:"mord mathrm"},"1")])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])]),s("span",{class:"mbin"},"+"),s("span",{class:"mord"},[s("span",{class:"mord mathit",style:{"margin-right":"0.07847em"}},"X"),s("span",{class:"vlist"},[s("span",{style:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.07847em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle scriptstyle cramped"},[s("span",{class:"mord mathrm"},"2")])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])]),s("span",{class:"mbin"},"+"),s("span",{class:"mord mathrm"},"."),s("span",{class:"mord mathrm"},"."),s("span",{class:"mord mathrm"},"."),s("span",{class:"mbin"},"+"),s("span",{class:"mord"},[s("span",{class:"mord mathit",style:{"margin-right":"0.07847em"}},"X"),s("span",{class:"vlist"},[s("span",{style:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.07847em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle scriptstyle cramped"},[s("span",{class:"mord mathit"},"n")])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])]),s("span",{class:"mclose"},")")])])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])]),s("span",{class:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])]),s("span",{style:{top:"2.423033em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"mord displaystyle textstyle uncramped"}),s("span",{class:"mrel"},"="),s("span",{class:"mord reset-textstyle displaystyle textstyle uncramped"},[s("span",{class:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist"},[s("span",{style:{top:"0.686em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle textstyle cramped"},[s("span",{class:"mord textstyle cramped"},[s("span",{class:"mord mathit"},"n")])])]),s("span",{style:{top:"-0.22999999999999998em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle textstyle uncramped frac-line"})]),s("span",{style:{top:"-1.3676689999999998em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle textstyle uncramped"},[s("span",{class:"mord textstyle uncramped"},[s("span",{class:"mop op-limits"},[s("span",{class:"vlist"},[s("span",{style:{top:"0.8776689999999999em","margin-left":"0em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle scriptstyle cramped"},[s("span",{class:"mord scriptstyle cramped"},[s("span",{class:"mord mathit"},"i"),s("span",{class:"mrel"},"="),s("span",{class:"mord mathrm"},"1")])])]),s("span",{style:{top:"-0.000005000000000088267em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",null,[s("span",{class:"op-symbol small-op mop"},"∑")])]),s("span",{style:{top:"-0.9500050000000002em","margin-left":"0em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle scriptstyle uncramped"},[s("span",{class:"mord mathit"},"n")])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])]),s("span",{class:"mord"},[s("span",{class:"mord mathit",style:{"margin-right":"0.07847em"}},"X"),s("span",{class:"vlist"},[s("span",{style:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.07847em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"reset-textstyle scriptstyle cramped"},[s("span",{class:"mord mathit"},"i")])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])])])])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])]),s("span",{class:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])])])])])])])])],-1),q=a(`<p><code>Xn</code>表示按天统计计算得到的单条平均存储值，<code>n</code>表示天数。</p><p><code>PostgreSQL</code>可以通过<code>information_schema.tables</code>查询每个表分区（每天）的存储占用情况，统计sql语句如下。</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	table_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;表名&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	pg_size_pretty(pg_relation_size(quote_ident(table_schema) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;.&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> quote_ident(table_name))) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;占用存储空间&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	information_schema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tables</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	table_schema </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;public&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">like</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;source_location_current_%&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">order by</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	table_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>通过该统计语句查询测试环境的实际数据占用空间情况如下。</p><p><img src="`+m+`" alt="image-20240731101125883"></p><p>有了每个表分区24H的存储占用空间信息，再结合分区表的数据量，即可大致评估计算出每天/单条事件的存储容量，通过<code>pg_catalog.pg_class</code>可以查询每个表分区（每天）的数据量情况，分区数据量的统计sql语句以及结果如下。</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	relname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;表名&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	reltuples::</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bigint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;数据量&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	pg_catalog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pg_class</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	relname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">like</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;source_location_current_________&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> order by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> relname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p><img src="`+c+`" alt="image-20240731101027512"></p><blockquote><p><strong>📌 知识小拓展</strong></p><p>实际应用中发现存在查询得到的分区表数据量为0的情况，需要通过<code>analyse</code>语法进行手动刷新。具体可以参考”<a href="https://blog.csdn.net/qq_40985985/article/details/128835076" target="_blank" rel="noreferrer">Postgresql pg_class查看所有表名relname及记录数reltuples，记录数显示0实际有数据解决</a>“博客。</p></blockquote><p>然后对以上两块数据通过时间进行关联查询，即可得到每个分区表单条数据的平均占用空间，统计sql语句以及结果如下：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">table_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;表名&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">row_count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;数据量&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;占用存储空间（KB）&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	round</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">numeric</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">row_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">numeric</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;单条数据占用空间（KB）&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	select</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		table_name, (pg_relation_size(quote_ident(table_schema) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;.&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> quote_ident(table_name))</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> size</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	from</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		information_schema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tables</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	where</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		table_schema </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;public&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">like</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;source_location_current_%&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) t1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	select</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		relname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table_name, reltuples::</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bigint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> row_count</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		pg_class</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	where</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		relname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">like</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;source_location_current_%&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) t2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">table_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">table_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">row_count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">order by</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">table_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p><img src="`+o+'" alt="image-20240731103008354"></p><p>因此即可按天查询得到分区表的单条数据占用空间（KB），根据算数平均值计算公式，计算得到<strong>单条事件存储容量约为1.1KB</strong>。</p>',13),x=s("p",null,[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",null,[s("semantics",null,[s("mrow",null,[s("mtable",null,[s("mtr",null,[s("mtd",null,[s("mrow",null,[s("mi",null,"S"),s("mi",null,"t"),s("mi",null,"o"),s("mi",null,"r"),s("mi",null,"a"),s("mi",null,"g"),s("mi",null,"e"),s("mi",{mathvariant:"normal"},"/"),s("mn",null,"2"),s("mn",null,"4"),s("mi",null,"H")])]),s("mtd",null,[s("mrow",null,[s("mrow"),s("mo",null,"="),s("mn",null,"1"),s("mi",{mathvariant:"normal"},"."),s("mn",null,"1"),s("mi",null,"K"),s("mi",null,"B"),s("mo",null,"×"),s("mn",null,"1"),s("mi",{mathvariant:"normal"},"."),s("mn",null,"5"),s("mo",null,"×"),s("mn",null,"1"),s("mn",null,"6"),s("mn",null,"5"),s("mn",null,"6"),s("mn",null,"9"),s("mn",null,"8"),s("mn",null,"6"),s("mn",null,"2"),s("mn",null,"4")])])]),s("mtr",null,[s("mtd",null,[s("mrow")])]),s("mtr",null,[s("mtd",null,[s("mrow")]),s("mtd",null,[s("mrow",null,[s("mrow"),s("mo",null,"≈"),s("mn",null,"2"),s("mn",null,"6"),s("mn",null,"0"),s("mi",{mathvariant:"normal"},"."),s("mn",null,"7"),s("mn",null,"3"),s("mn",null,"7"),s("mn",null,"1"),s("mn",null,"6"),s("mn",null,"1"),s("mn",null,"3"),s("mi",null,"G"),s("mi",null,"B")])])])])]),s("annotation",{encoding:"application/x-tex"},"\\begin{aligned} Storage/24H&=1.1KB\\times1.5\\times165698624\\\\\\\\ & \\approx 260.7371613GB \\end{aligned} ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"strut",style:{height:"2.05em"}}),s("span",{class:"strut bottom",style:{height:"3.6000000000000005em","vertical-align":"-1.5500000000000007em"}}),s("span",{class:"base displaystyle textstyle uncramped"},[s("span",{class:"mord"},[s("span",{class:"mtable"},[s("span",{class:"col-align-r"},[s("span",{class:"vlist"},[s("span",{style:{top:"-1.2099999999999997em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"mord mathit",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"mord mathit"},"t"),s("span",{class:"mord mathit"},"o"),s("span",{class:"mord mathit",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"mord mathit"},"a"),s("span",{class:"mord mathit",style:{"margin-right":"0.03588em"}},"g"),s("span",{class:"mord mathit"},"e"),s("span",{class:"mord mathrm"},"/"),s("span",{class:"mord mathrm"},"2"),s("span",{class:"mord mathrm"},"4"),s("span",{class:"mord mathit",style:{"margin-right":"0.08125em"}},"H")])]),s("span",{style:{top:"-0.00999999999999951em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"})]),s("span",{style:{top:"1.1900000000000006em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"})]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])]),s("span",{class:"col-align-l"},[s("span",{class:"vlist"},[s("span",{style:{top:"-1.2099999999999997em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"mord displaystyle textstyle uncramped"}),s("span",{class:"mrel"},"="),s("span",{class:"mord mathrm"},"1"),s("span",{class:"mord mathrm"},"."),s("span",{class:"mord mathrm"},"1"),s("span",{class:"mord mathit",style:{"margin-right":"0.07153em"}},"K"),s("span",{class:"mord mathit",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"mbin"},"×"),s("span",{class:"mord mathrm"},"1"),s("span",{class:"mord mathrm"},"."),s("span",{class:"mord mathrm"},"5"),s("span",{class:"mbin"},"×"),s("span",{class:"mord mathrm"},"1"),s("span",{class:"mord mathrm"},"6"),s("span",{class:"mord mathrm"},"5"),s("span",{class:"mord mathrm"},"6"),s("span",{class:"mord mathrm"},"9"),s("span",{class:"mord mathrm"},"8"),s("span",{class:"mord mathrm"},"6"),s("span",{class:"mord mathrm"},"2"),s("span",{class:"mord mathrm"},"4")])]),s("span",{style:{top:"1.1900000000000002em"}},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),s("span",{class:"mord displaystyle textstyle uncramped"},[s("span",{class:"mord displaystyle textstyle uncramped"}),s("span",{class:"mrel"},"≈"),s("span",{class:"mord mathrm"},"2"),s("span",{class:"mord mathrm"},"6"),s("span",{class:"mord mathrm"},"0"),s("span",{class:"mord mathrm"},"."),s("span",{class:"mord mathrm"},"7"),s("span",{class:"mord mathrm"},"3"),s("span",{class:"mord mathrm"},"7"),s("span",{class:"mord mathrm"},"1"),s("span",{class:"mord mathrm"},"6"),s("span",{class:"mord mathrm"},"1"),s("span",{class:"mord mathrm"},"3"),s("span",{class:"mord mathit"},"G"),s("span",{class:"mord mathit",style:{"margin-right":"0.05017em"}},"B")])]),s("span",{class:"baseline-fix"},[s("span",{class:"fontsize-ensurer reset-size5 size5"},[s("span",{style:{"font-size":"0em"}},"​")]),i("​")])])])])])])])])])],-1),T=a(`<p>最后按照50%的冗余量进行计算，可以得到<strong>一台服务器/24H接入的存储容量上限约为260GB</strong>。</p><h3 id="分析结果" tabindex="-1">分析结果 <a class="header-anchor" href="#分析结果" aria-label="Permalink to &quot;分析结果&quot;">​</a></h3><p>根据以上数据性能评估，总结得到如下几个性能参数（<em>注：以下数据在计算过程中均考虑了冗余量</em>）：</p><ul><li>单线程、单条事件报文平均消费耗时约为<strong>7.3毫秒</strong>，单线程24小时的消费能力上限约为<strong>600万条</strong>；</li><li>以24核CPU，62GB内存服务器为例，设置<strong>28并发</strong>消费线程数，一台服务器/24H的理论消费能力上限约为<strong>1.6亿条</strong>；</li><li>PostgreSQL轻量化存储场景，单条事件存储容量约为<strong>1.1KB</strong>，一台服务器/24H接入的存储容量上限约为<strong>260GB</strong>；</li></ul><h2 id="知识点总结" tabindex="-1">知识点总结 <a class="header-anchor" href="#知识点总结" aria-label="Permalink to &quot;知识点总结&quot;">​</a></h2><h3 id="知识点1-若干常用linux服务器指令" tabindex="-1">知识点1：若干常用Linux服务器指令 <a class="header-anchor" href="#知识点1-若干常用linux服务器指令" aria-label="Permalink to &quot;知识点1：若干常用Linux服务器指令&quot;">​</a></h3><ul><li>查看服务器基本系统信息指令：<code>lscpu</code>；</li><li>查看服务器内存使用情况：<code>free -h</code>；</li><li>查看当前服务器CPU使用情况：<code>top -c</code>，想要查看各个CPU内核使用状况，继续按1；</li><li>日志实时打印指令：<code>tail -f</code>，示例：<code>tail -f slf.slf-data-entry.debug.log |grep &#39;Message time&#39;</code>，可以结合<code>grep</code>进行关键字过滤，；</li><li>根据关键字日志提取指令：<code>cat</code> ，示例：<code>cat slf.slf-data-entry.debug.log | grep &#39;Message time&#39; &gt; output.txt</code>；</li></ul><h3 id="知识点2-配置rabbitmq多线程消费" tabindex="-1">知识点2：配置RabbitMQ多线程消费 <a class="header-anchor" href="#知识点2-配置rabbitmq多线程消费" aria-label="Permalink to &quot;知识点2：配置RabbitMQ多线程消费&quot;">​</a></h3><p>通过配置<code>@RabbitListener</code>的<code>concurrency</code>参数实现并行消费，需要注意这个参数不是越大越好，需要结合实际服务器的硬件资源进行合理分配，注解参考示例如下。</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RabbitListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> QUEUE, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bindings</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">QueueBinding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Queue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> QUEUE, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">durable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;true&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		exchange</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Exchange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Constants.ESC_EVENT_SUBSCRIPTION_EXCHANGE, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ExchangeTypes.FANOUT)),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		messageConverter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;myJackson2JsonMessageConverter&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">concurrency</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;\${slf-data-entry.rabbitmq.listener.concurrency.esc-location-event:5}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>另外拓展看下这个参数的源码注解，可以发现除了配置固定的消费线程数以外，还可以通过<code>&quot;m-n&quot;</code>格式分别配置<code>concurrentConsumers</code>和<code>maxConcurrentConsumers</code>，可以简单理解成就是消费线程池的核心线程数与最大线程数。</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * Set the concurrency of the listener container for this listener. Overrides the</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * default set by the listener container factory. Maps to the concurrency setting of</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * the container type.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * &lt;p&gt;For a</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * {@link org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * SimpleMessageListenerContainer} if this value is a simple integer, it sets a fixed</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * number of consumers in the {@code concurrentConsumers} property. If it is a string</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * with the form {@code &quot;m-n&quot;}, the {@code concurrentConsumers} is set to {@code m}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * and the {@code maxConcurrentConsumers} is set to {@code n}.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * &lt;p&gt;For a</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * {@link org.springframework.amqp.rabbit.listener.DirectMessageListenerContainer</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * DirectMessageListenerContainer} it sets the {@code consumersPerQueue} property.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@return</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> the concurrency.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@since</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 2.0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">String </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">concurrency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h3 id="知识点3-postgresql分区存储" tabindex="-1">知识点3：PostgreSQL分区存储 <a class="header-anchor" href="#知识点3-postgresql分区存储" aria-label="Permalink to &quot;知识点3：PostgreSQL分区存储&quot;">​</a></h3><p>PostgreSQL10开始支持分区表PARTITION机制。分区指的是将逻辑上的一个大表分成更小的物理块。PostgreSQL11可实现3种表分区：范围分区（RANGE），列表分区（LIST ）和哈希分区（HASH）。分区可以提供几个好处：</p><ul><li>在某些情况下，查询性能可以得到显著提高，特别是当表中大多数访问量很大的行位于单个分区或少量分区中时。分区有效地替代了索引的上层树级别，使得索引中频繁使用的部分更有可能适合内存。</li><li>当查询或更新访问单个分区的很大一部分时，可以通过对该分区进行顺序扫描而不是使用索引来提高性能，因为索引需要在整个表中分散进行随机访问读取。</li><li>如果在分区设计中考虑了使用模式，则可以通过添加或删除分区来完成批量加载和删除。使用<code>DROP TABLE</code>删除单个分区，或者执行<code>ER TABLE DETACH partition</code>，要比批量操作快得多。这些命令还完全避免了批量DELETE操作造成的VACUUM开销。</li><li>很少使用的数据可以迁移到更便宜和更慢的存储介质上。</li></ul><p>以上摘自PostgreSQL官网”<a href="https://www.postgresql.org/docs/11/ddl-partitioning.html" target="_blank" rel="noreferrer">5.10. Table Partitioning</a>“，感兴趣或者用得着的小伙伴直接去官网逛逛吧。</p><h3 id="知识点4-性能估算的若干指标项" tabindex="-1">知识点4：性能估算的若干指标项 <a class="header-anchor" href="#知识点4-性能估算的若干指标项" aria-label="Permalink to &quot;知识点4：性能估算的若干指标项&quot;">​</a></h3><p>对程序进行性能评估，少不了统计单位程序对单位数据的<strong>处理耗时</strong>，<strong>消耗内存</strong>，<strong>硬盘存储</strong>等信息，并且结合可视化打印和统计分析手段，计算获得<strong>数据量</strong>、<strong>平均值</strong>以及<strong>众数</strong>等体现具体程序数量级的参数。</p><p>另外我们在进行公式计算的过程中，需要充分考虑<strong>冗余量</strong>指标，使得最终计算得到的数据更加接近实际生产场景和提前预留风险值。</p><h2 id="结束语" tabindex="-1">结束语 <a class="header-anchor" href="#结束语" aria-label="Permalink to &quot;结束语&quot;">​</a></h2><p>通过统计分析得到的程序性能参数让我感到十分意外和惊讶，因为整个消费能力以及数量级远超我的预期。当然，不排除其中统计分析手段或者参数公式等存在错误的可能，希望发现了的小伙伴能够及时指正，欢迎各抒己见。</p><p>最后的最后，祝你生活愉快，盆友~<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup></p><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>空间位置融合应用接收人、车、船、物等对象的各种位置数据，通过拟合纠偏算法进行时空融合统一解算，解算出人、车、船、物等对象的准确位置，结合地图提供目标实时位置展示、锁定追踪、移动路线查询等功能。 <a href="#fnref1" class="footnote-backref">↩︎</a></p></li><li id="fn2" class="footnote-item"><p>KVM(Kernel-Based Virtual Machines)是一个基于Linux内核的虚拟化技术, 可以直接将Linux内核转换为Hypervisor（系统管理程序）从而使得Linux内核能够直接管理虚拟机, 直接调用Linux内核中的内存管理、进程管理子系统来管理虚拟机。 <a href="#fnref2" class="footnote-backref">↩︎</a></p></li><li id="fn3" class="footnote-item"><p>“多言数穷，不如守中。”---created by 袁志鹏 on 五月 28,2024 edited by 袁志鹏 on 八月 1,2024 <a href="#fnref3" class="footnote-backref">↩︎</a></p></li></ol></section>`,24),M=[g,y,F,u,B,C,_,f,D,A,b,z,v,q,x,T];function U(G,S,P,w,L,R){return e(),l("div",null,M)}const N=n(E,[["render",U]]);export{O as __pageData,N as default};
