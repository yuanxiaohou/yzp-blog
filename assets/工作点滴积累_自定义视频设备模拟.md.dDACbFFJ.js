import{_ as a,c as t,o as e,a4 as o}from"./chunks/framework.uKVmtqZI.js";const r="/assets/%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF1.NFxx2ghi.png",s="/assets/%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF2.BFw5IRbX.png",i="/assets/%E8%A7%86%E9%A2%91%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%8D%A21.BaavVBq8.png",p="/assets/%E8%A7%86%E9%A2%91%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%8D%A22.C1wptU3w.png",l="/assets/%E8%A7%86%E9%A2%91%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%8D%A23.9mnlt3mA.png",n="/assets/image-20240109164707257.BK_Kq3mD.png",c="/assets/image-20240109172042378.Crckuayo.png",h="/assets/%E7%B4%A0%E6%9D%90%E8%A7%86%E9%A2%91%E4%B8%8A%E4%BC%A0.ZPaCVegv.png",d="/assets/%E9%85%8D%E7%BD%AE%E6%A8%A1%E6%8B%9F%E8%AE%BE%E5%A4%871.9g4kVFML.png",m="/assets/%E9%85%8D%E7%BD%AE%E6%A8%A1%E6%8B%9F%E8%AE%BE%E5%A4%872.CwsrGk5M.png",u="/assets/%E6%A8%A1%E6%8B%9F%E8%AE%BE%E5%A4%87%E9%AA%8C%E8%AF%811.BAhd1lSj.png",g="/assets/%E6%A8%A1%E6%8B%9F%E8%AE%BE%E5%A4%87%E9%AA%8C%E8%AF%812.CFsXJwnY.png",E="/assets/%E6%A8%A1%E6%8B%9F%E8%AE%BE%E5%A4%87%E9%AA%8C%E8%AF%813.DvBaS3G2.png",_="/assets/HCSimulator%E6%A8%A1%E6%8B%9F1.DyfNJUOF.png",A="/assets/HCSimulator%E6%A8%A1%E6%8B%9F2.DOLX1bVk.png",k="/assets/HCSimulator%E6%A8%A1%E6%8B%9F3.BlJY5PMr.png",v=JSON.parse('{"title":"自定义视频设备模拟","description":"","frontmatter":{},"headers":[],"relativePath":"工作点滴积累/自定义视频设备模拟.md","filePath":"工作点滴积累/自定义视频设备模拟.md"}'),f={name:"工作点滴积累/自定义视频设备模拟.md"},b=o('<h1 id="自定义视频设备模拟" tabindex="-1">自定义视频设备模拟 <a class="header-anchor" href="#自定义视频设备模拟" aria-label="Permalink to &quot;自定义视频设备模拟&quot;">​</a></h1><h2 id="🍄-背景简介" tabindex="-1">🍄 背景简介 <a class="header-anchor" href="#🍄-背景简介" aria-label="Permalink to &quot;🍄 背景简介&quot;">​</a></h2><p>日常工作中，为了测试视频类功能，经常需要在平台上添加IPC视频设备进行测试。最常用的方式当然是借调一个物理测试设备，添加到平台即可打完收工。</p><p>但是在一些特定的场景中，需要模拟特定场景的视频片段，用物理设备怼着一个显示屏当然也能实现，但是多少有点繁琐，本文将介绍两种其他方式：HiCe平台模拟和HCSimulator模拟，除此以外展开介绍一个公司的共享物理设备平台申请和使用方式。</p><h2 id="🍓-基础知识点" tabindex="-1">🍓 基础知识点 <a class="header-anchor" href="#🍓-基础知识点" aria-label="Permalink to &quot;🍓 基础知识点&quot;">​</a></h2><p>我们常常认为每个视频的后缀名（扩展名）就是视频的格式，常见的视频文件后缀名有：MP4、MKV、AVI、MOV等，其实这些后缀名只是代表了视频的封装格式，视频还有编码格式。</p><p>这两者的关系好比酒与酒瓶的关系，编码格式好比酒瓶里的酒，是视频的核心内容，封装格式好比酒瓶，它只是负责把内部的视频轨、音频轨、字幕轨集成在一起。</p><h3 id="视频编码格式" tabindex="-1">视频编码格式 <a class="header-anchor" href="#视频编码格式" aria-label="Permalink to &quot;视频编码格式&quot;">​</a></h3><p>所谓视频编码方式就是指通过压缩技术，将原始视频格式的文件转换成另一种视频格式文件的方式。</p><p>视频流传输中最为重要的编解码标准有国际电联的H.261、H.263、H.264，运动静止图像专家组的M-JPEG和国际标准化组织运动图像专家组的MPEG系列标准，此外在互联网上被广泛应用的还有Real-Networks的RealVideo、微软公司的WMV以及Apple公司的QuickTime等。</p><p>在视频监控领域，我们常说的H.264和H.265，指的即是视频编码格式。</p><h3 id="视频封装格式" tabindex="-1">视频封装格式 <a class="header-anchor" href="#视频封装格式" aria-label="Permalink to &quot;视频封装格式&quot;">​</a></h3><p>视频封装是将已经编码处理的视频数据、音频数据、字幕数据等按照一定的方式放到一个文件中，这个文件的格式就是视频封装格式，如果一个视频文件是以某个格式封装起来的，那么它的文件后缀名一般会体现出来。</p><p>常见封装格式包括：<strong>MP4、AVI、WMV、FLV、MOV、TS</strong>。</p><blockquote><p><strong>📌 备注</strong></p><p>文件后缀名只能作为一个判断依据，具体视频的封装格式不能完全以后缀名来断定。</p></blockquote><p>对于离线观看的视频，格式就非常重要了，一般电脑或手机自带的视频播放器不一定能够很好地兼容这些格式，因此建议大家选择一个解码能力强大的万能视频播放器，市面上可供选择的有VLC、PotPlayer、KMPlayer、MPV、MPC-HC、MPC-BE等等。</p><h2 id="🍀-视频处理" tabindex="-1">🍀 视频处理 <a class="header-anchor" href="#🍀-视频处理" aria-label="Permalink to &quot;🍀 视频处理&quot;">​</a></h2><p>接下来介绍如何转换得到支持视频模拟的视频片段。</p><p>通过海康平台以及客户端下载的视频，一般建议通过<strong>VSPlayer海康播放器</strong>（可自行下载，或者从附件中直接获取）进行查看以及转码。</p><p>我们拿到一段视频，即可以通过该工具查看视频的编码格式和封装格式。</p><p><img src="'+r+'" alt="视频文件信息1"></p><p><img src="'+s+'" alt="视频文件信息2"></p><p>另外通过该工具可以进行视频转码，比如模拟视频的要求是<strong>HIK封装格式</strong>操作方式如下：</p><p><img src="'+i+'" alt="视频格式转换1"></p><p><img src="'+p+'" alt="视频格式转换2"></p><p><img src="'+l+'" alt=""></p><h2 id="🌵-设备共享平台" tabindex="-1">🌵 设备共享平台 <a class="header-anchor" href="#🌵-设备共享平台" aria-label="Permalink to &quot;🌵 设备共享平台&quot;">​</a></h2><p>如果只是简单地测试设备预览，但是手头又没有物理设备，可以推荐一个公共设备借调的平台-----》<a href="http://king.hiktest.com/#/assetSquare" target="_blank" rel="noreferrer">设备广场</a>。</p><blockquote><p><strong>📌 备注</strong></p><p>设备广场的使用问题可咨询：程工（程念）,谢工（谢璞）。</p></blockquote><p><img src="'+n+'" alt="image-20240109164707257"></p><p>按照页面的提示，完成设备申请之后，就会收到如下这样一个设备连接信息的邮件，之后当做一个普通的编码设备添加到平台即可。</p><p><img src="'+c+'" alt="image-20240109172042378"></p><h2 id="🌴-hiktest平台模拟" tabindex="-1">🌴 HikTest平台模拟 <a class="header-anchor" href="#🌴-hiktest平台模拟" aria-label="Permalink to &quot;🌴 HikTest平台模拟&quot;">​</a></h2><p><a href="http://hiktest.hikvision.com.cn" target="_blank" rel="noreferrer">一站式测试管理平台</a>主要辅助业务项目开展测试工作，“构建以&lt;规范&gt;为核心、以&lt;需求&gt;为牵引、以&lt;策略&gt;为中枢的项目测试标准化流程”，逐步收紧原来不标准、零散定制的功能与流程，并面向用户提供业务化、统一的一站式测试工作台，将测试活动统一到一个地方，集成了测试用例管理、测试项目执行、测试评审流程、缺陷管理、数据可视化、待办等各类应用能力。<sup>摘自“<a href="http://hiktest.hikvision.com.cn/mindoc/docs/one" target="_blank" rel="noreferrer">一站式用户手册</a>”平台介绍章节</sup></p><h3 id="上传素材视频文件" tabindex="-1">上传素材视频文件 <a class="header-anchor" href="#上传素材视频文件" aria-label="Permalink to &quot;上传素材视频文件&quot;">​</a></h3><p>模拟视频支持<strong>150M</strong>以下的短视频（超出部分会被自动截断），另外对模拟视频文件的格式也有一定的要求，需要转换成<strong>HIK封装格式</strong>的视频，视频的转换可以参考“[🍀 视频处理](#🍀 视频处理)”章节。</p><p>准备好模拟视频之后，通过“<a href="http://king.hiktest.com/#/folder?fId=-1&amp;t=1706671689864" target="_blank" rel="noreferrer">样本管理</a>”平台统一上传管理。</p><p><img src="'+h+'" alt=""></p><h3 id="配置模拟设备" tabindex="-1">配置模拟设备 <a class="header-anchor" href="#配置模拟设备" aria-label="Permalink to &quot;配置模拟设备&quot;">​</a></h3><p>上传完模拟视频文件之后，回到<a href="http://hiktest.hikvision.com.cn/#/app/mockserver/device/hik/request" target="_blank" rel="noreferrer">一站式测试管理平台-设备模拟</a>模块。</p><p><img src="'+d+'" alt=""></p><p>按照提示填写相关的设备基础信息，并且在视频配置页面，选择添加“<a href="#准备素材视频文件">准备素材视频文件</a>”章节上传的视频素材。</p><p><img src="'+m+'" alt=""></p><h3 id="模拟设备验证" tabindex="-1">模拟设备验证 <a class="header-anchor" href="#模拟设备验证" aria-label="Permalink to &quot;模拟设备验证&quot;">​</a></h3><p>配置完模拟设备并且启动之后，即可以看到一个运行中的模拟设备。</p><p><img src="'+u+'" alt=""></p><p>将模拟设备添加到平台即可验证视频是否模拟成功。</p><p><img src="'+g+'" alt=""></p><p>能够正常预览查看视频，即表示自定义视频模拟成功。</p><p><img src="'+E+'" alt=""></p><h2 id="🌲-hcsimulator模拟" tabindex="-1">🌲 HCSimulator模拟 <a class="header-anchor" href="#🌲-hcsimulator模拟" aria-label="Permalink to &quot;🌲 HCSimulator模拟&quot;">​</a></h2><p>有一些模拟场景，对于视频的素材大小有一定的要求，所以上文中的“测试平台”模拟方式有一定的局限性。为了实现长度不受限制视频的模拟，推荐可以使用HCSimulator客户端模拟工具。</p><p>HCSimulator是一款基于设备私有网络通信协议、ISAPI协议、ISUP协议、OTAP协议开发的模拟设备，用于模拟真实设备功能供平台测试使用，以exe程序提供，只包含win32版本，模拟设备主要功能包括参数配置，预览，对讲，回放，报警等。</p><blockquote><p><strong>📌 备注</strong></p><p>HCSimulator模拟的使用问题可咨询：陈工（陈国烨）,王工（王东亮6）。</p></blockquote><h3 id="准备工作" tabindex="-1">准备工作 <a class="header-anchor" href="#准备工作" aria-label="Permalink to &quot;准备工作&quot;">​</a></h3><blockquote><p><strong>📣 注意事项</strong></p><ul><li>支持操作系统：2003 Server 32，Win7 32位/64位，2008 Server 32，Win8 32位/64位，Win8.1 32位/64位，Win10 32位/64位；</li><li>模拟设备目录所在路径不能有中文、空格；</li><li>模拟设备配置界面的IP地址必须是本地PC的IP，端口是未被占用的任意端口。</li></ul></blockquote><p>0、首先下载模拟工具，可参考&quot;<a href="https://wiki.hikvision.com.cn/pages/viewpage.action?pageId=169485844" target="_blank" rel="noreferrer">HCSimulator模拟点位工具</a><sup>Wiki</sup>&quot;，或者直接从附件中获取；</p><p>1、参考“<strong>海康模拟设备工具_用户使用手册V2.5.0.docx</strong>”文档“<strong>2 获取使用License</strong>”章节申请授权信息；</p><p>2、参考“[🍀 视频处理](#🍀 视频处理)”章节转换<strong>PS封装格式</strong>的视频，替换<code>HCSimulatorV2.5.0.15_build20230824_WIN32_ZH\\lib\\StreamFiles</code>目录里面的<code>Preview.mp4</code>视频文件（可参考“<strong>替换自定义音视频文件说明.docx</strong>”）；</p><p>3、修改<code>HCSimulatorV2.5.0.15_build20230824_WIN32_ZH\\lib</code>目录下<code>PrivateDevice.xml</code>文件，把设备的<code>PreviewVedioSrc</code>参数设置为1（0-读内存方式；1-读文件方式），同时注意<code>\\Temp</code>文件夹下面的<code>temp_1.xml</code>也同步修改（这里列举的文件可能需要启动程序之后才会生成）。</p><h3 id="单路视频模拟" tabindex="-1">单路视频模拟 <a class="header-anchor" href="#单路视频模拟" aria-label="Permalink to &quot;单路视频模拟&quot;">​</a></h3><p>完成以上准备工作之后，即可打开<code>HCSimulateDevice.exe</code>模拟程序，配置模拟设备的IP，端口等信息；</p><p><img src="'+_+'" alt="HCSimulator模拟1"></p><p>除了基本信息以外，需要注意配置预览视频的发包大小以及时间间隔，这个推流速率可以根据文件时间长度和大小约莫估计算每秒需要发送多少字节，以此推算出一个相对合理的数值；</p><p><img src="'+A+'" alt="HCSimulator模拟2"></p><p>完成以上配置之后，检查参数无误之后，启动该模拟设备，并且配置到平台验证效果。</p><p><img src="'+k+'" alt="HCSimulator模拟3"></p><h3 id="多路视频模拟" tabindex="-1">多路视频模拟 <a class="header-anchor" href="#多路视频模拟" aria-label="Permalink to &quot;多路视频模拟&quot;">​</a></h3><p>模拟设备支持按通道取流，每个通道配置不同的视频文件，具体参考&quot;<strong>私有模拟设备支持按通道取流.docx</strong>&quot;文档操作吧。</p><h2 id="🌱-参考资料" tabindex="-1">🌱 参考资料 <a class="header-anchor" href="#🌱-参考资料" aria-label="Permalink to &quot;🌱 参考资料&quot;">​</a></h2><ul><li><a href="http://stt.hiktest.com/mindoc/docs/hice/hice-1cdn2dsgs7v60" target="_blank" rel="noreferrer">HiCe学堂-设备模拟</a><sup>HiCe</sup></li><li><a href="https://wiki.hikvision.com.cn/pages/viewpage.action?pageId=169485844" target="_blank" rel="noreferrer">HCSimulator模拟点位工具</a><sup>Wiki</sup></li><li>海康模拟设备工具_用户使用手册V2.5.0.docx<sup>Word</sup></li><li>替换自定义音视频文件说明.docx<sup>Word</sup></li><li>私有模拟设备支持按通道取流.docx<sup>Word</sup></li></ul><h2 id="🌼-特别感谢" tabindex="-1">🌼 特别感谢 <a class="header-anchor" href="#🌼-特别感谢" aria-label="Permalink to &quot;🌼 特别感谢&quot;">​</a></h2><ul><li>特别感谢<strong>王工（王东亮6）</strong>，解答了若干视频模拟方面的问题，并且提供给我HCSimulator模拟工具；</li><li>特别感谢<strong>陈工（陈国烨）</strong>，帮忙排查解决HCSimulator模拟工具使用过程中遇到的问题；</li><li>额外感谢<strong>张工（张倩26）</strong>，在我四处碰壁的过程中，给过我一些帮助；</li></ul><h2 id="🌙-写在最后面的话" tabindex="-1">🌙 写在最后面的话 <a class="header-anchor" href="#🌙-写在最后面的话" aria-label="Permalink to &quot;🌙 写在最后面的话&quot;">​</a></h2><p>我对以上工具的使用可以说只是九牛一毛，但是本次的目标即“自定义视频设备模拟”，所以其他的功能不过多介绍，感兴趣的请自行探索。另外可能公司还有另外更好的工具能实现以上功能，也鼓励你及时分享。</p><p>2024伊始，祝身心健康，一帆风顺，盆友~<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>“人生在世不称意，明朝散发弄扁舟。”---created by 袁志鹏 on 一月 8,2024 edited by 袁志鹏 on 二月 1,2024 <a href="#fnref1" class="footnote-backref">↩︎</a></p></li></ol></section>',78),q=[b];function C(P,B,S,H,x,F){return e(),t("div",null,q)}const D=a(f,[["render",C]]);export{v as __pageData,D as default};
