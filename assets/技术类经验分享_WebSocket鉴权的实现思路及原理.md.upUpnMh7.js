import{_ as s,c as i,o as a,a4 as n}from"./chunks/framework.CUMjAKNJ.js";const h="/yzp-blog/assets/%E7%B1%BB%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB%E8%AE%BE%E8%AE%A1.D28d6Vw2.png",k="/yzp-blog/assets/%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92%E6%97%B6%E5%BA%8F%E8%AE%BE%E8%AE%A1.CRAfMk4M.png",t="/yzp-blog/assets/%E9%89%B4%E6%9D%83%E8%AE%BE%E8%AE%A1.FWH-MomS.png",l="/yzp-blog/assets/%E9%89%B4%E6%9D%83%E5%A4%B1%E8%B4%A5.DiG_XUdf.png",p="/yzp-blog/assets/%E9%97%A8%E6%88%B7%E8%8E%B7%E5%8F%96Cookie.BsQjSNYr.png",e="/yzp-blog/assets/%E9%89%B4%E6%9D%83%E6%88%90%E5%8A%9F.DjQEskaB.png",u=JSON.parse('{"title":"WebSocketé‰´æƒçš„å®ç°æ€è·¯åŠåŸç†","description":"","frontmatter":{},"headers":[],"relativePath":"æŠ€æœ¯ç±»ç»éªŒåˆ†äº«/WebSocketé‰´æƒçš„å®ç°æ€è·¯åŠåŸç†.md","filePath":"æŠ€æœ¯ç±»ç»éªŒåˆ†äº«/WebSocketé‰´æƒçš„å®ç°æ€è·¯åŠåŸç†.md"}'),E={name:"æŠ€æœ¯ç±»ç»éªŒåˆ†äº«/WebSocketé‰´æƒçš„å®ç°æ€è·¯åŠåŸç†.md"},r=n('<h1 id="websocketé‰´æƒçš„å®ç°æ€è·¯åŠåŸç†" tabindex="-1">WebSocketé‰´æƒçš„å®ç°æ€è·¯åŠåŸç† <a class="header-anchor" href="#websocketé‰´æƒçš„å®ç°æ€è·¯åŠåŸç†" aria-label="Permalink to &quot;WebSocketé‰´æƒçš„å®ç°æ€è·¯åŠåŸç†&quot;">â€‹</a></h1><h2 id="ğŸŒ´èƒŒæ™¯ç®€ä»‹" tabindex="-1">ğŸŒ´èƒŒæ™¯ç®€ä»‹ <a class="header-anchor" href="#ğŸŒ´èƒŒæ™¯ç®€ä»‹" aria-label="Permalink to &quot;ğŸŒ´èƒŒæ™¯ç®€ä»‹&quot;">â€‹</a></h2><p>â€œç»¼åˆæ‰§æ³•â€åŸºçº¿çš„å¼€å‘ä¸­ä½¿ç”¨äº†<code>WebSocket</code>ï¼Œæœ¬æ¥æƒ³å€Ÿç€è¿™æ¬¡çš„å¼€å‘ç»éªŒè¯¦ç»†çš„è¯´ä¸‹WebSocketç›¸å…³çš„åŸºç¡€çŸ¥è¯†åŠé¡¹ç›®å®æˆ˜ã€‚ä½†æ˜¯æˆ‘åœ¨RDKnownä¸Šæœç´¢ä¹‹åå‘ç°å·²ç»æœ‰å¾ˆå¤šç±»ä¼¼ç›¸å…³çš„æ–‡ç« ï¼Œå¹¶ä¸”å…¶ä¸­æœ‰éƒ¨åˆ†å†™çš„å¾ˆå¥½ã€å¾ˆè¯¦ç»†ã€‚æ‰€ä»¥å°±æ‰“æ¶ˆäº†æˆ‘åˆ†äº«WebSocketåŸºç¡€æ¦‚å¿µåŠé¡¹ç›®é›†æˆç›¸å…³ä¸œè¥¿çš„å¿µå¤´ã€‚</p><p>ä½†æ˜¯å¤§æ¦‚ç¿»çœ‹äº†ä¸€éå‘ç°ï¼Œè¿™ä¹ˆå¤šçš„åˆ†äº«ä¸­ï¼Œæ„£æ˜¯æ²¡æœ‰ä¸€ç¯‡æœ‰æ¶‰åŠé‰´æƒç›¸å…³çš„çŸ¥è¯†ã€‚ é‚£ä¹ˆå°±ç»™WebSocketâ€œæŸ¥æ¼è¡¥ç¼ºâ€ï¼Œåˆ†äº«ä¸€ä¸‹JWTé‰´æƒ<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ç›¸å…³çš„å®ç°æ€è·¯å’ŒåŸç†å§ï¼Œäºæ­¤åŒæ—¶ä¹Ÿä¼šç¨å¾®å±•å¼€è®²ä¸‹å¯¹äºWebSocketçš„ç®€å•å°è£…æ€è·¯ã€‚</p><h3 id="åŸºç¡€ç¯å¢ƒä¿¡æ¯" tabindex="-1">åŸºç¡€ç¯å¢ƒä¿¡æ¯ <a class="header-anchor" href="#åŸºç¡€ç¯å¢ƒä¿¡æ¯" aria-label="Permalink to &quot;åŸºç¡€ç¯å¢ƒä¿¡æ¯&quot;">â€‹</a></h3><p>åœ¨å¼€å§‹è®²é‰´æƒä¹‹å‰ï¼Œæœ‰å¿…è¦å¤§æ¦‚è¯´ä¸‹å¯¹äºJavaå¼€å‘è€…è€Œè¨€ï¼Œç›®å‰åå°WebSocketæœåŠ¡ç«¯çš„å¼€å‘çš„å‡ ç§å¸¸ç”¨é€‰æ‹©ï¼š</p><ul><li><em>åŸºäºwebå®¹å™¨çš„websocket-apiåè®®ï¼Œæ¯”å¦‚undertow-websockets</em></li><li><em>Spring4 ä»¥åå¼€å§‹å†…ç½®æ”¯æŒ WebSocket</em></li><li><em>Netty3 ä»¥åæ”¯æŒå¼€å‘ WebSocketï¼Œæ¯”å¦‚Netty-SocketIO<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup></em></li></ul><p>è€Œæœ¬æ–‡æ˜¯åŸºäºwebsocket-apiå®ç°çš„WebSocketï¼Œå…·ä½“ä¾èµ–å…³ç³»å¦‚ä¸‹ï¼š</p><blockquote><p>spring-boot-starter-websocketï¼š2.6.11</p><p>javax.websocket-apiï¼š1.1</p><p>undertow-websockets-jsrï¼š2.2.19.Final</p><p>aries-jc-jwtï¼š3.1.4.RELEASE</p></blockquote><h2 id="ğŸŒµå®ç°æ€è·¯" tabindex="-1">ğŸŒµå®ç°æ€è·¯ <a class="header-anchor" href="#ğŸŒµå®ç°æ€è·¯" aria-label="Permalink to &quot;ğŸŒµå®ç°æ€è·¯&quot;">â€‹</a></h2><h3 id="ç±»ä¾èµ–å…³ç³»è®¾è®¡" tabindex="-1">ç±»ä¾èµ–å…³ç³»è®¾è®¡ <a class="header-anchor" href="#ç±»ä¾èµ–å…³ç³»è®¾è®¡" aria-label="Permalink to &quot;ç±»ä¾èµ–å…³ç³»è®¾è®¡&quot;">â€‹</a></h3><p><img src="'+h+'" alt="ç±»ä¾èµ–å…³ç³»è®¾è®¡"></p><p>é€šè¿‡<code>WebSocketServerAutoConfiguration</code>è‡ªåŠ¨é…ç½®ç±»æ„é€ <code>ServerEndpointExporter</code>ï¼Œç”¨æ¥æ‰«ææ³¨å…¥å¸¦<code>@ServerEndpoint</code>æ³¨è§£çš„æ¶ˆæ¯å¤„ç†ç±»ã€‚</p><p><code>AbstractSocketMessageHandler</code>äº‹ä»¶å¤„ç†æŠ½è±¡ç±»ï¼Œå†…éƒ¨é»˜è®¤å®ç°äº†<code>@OnOpen</code>å»ºç«‹è¿æ¥ï¼Œ<code>@OnClose</code>å…³é—­è¿æ¥ï¼Œ<code>@OnError</code>å¼‚å¸¸å¤„ç†ï¼Œ<code>@OnMessage</code>æ¶ˆæ¯æ¥æ”¶ç­‰ç­‰åŸºç¡€WebSocketæœåŠ¡ï¼Œè¿™æ ·ä¸€æ¥åœ¨ä¸šåŠ¡å¤„ç†å±‚å°±ä¸éœ€è¦é‡å¤å®ç°è¿™äº›åŸºæœ¬é€šç”¨çš„é€»è¾‘ï¼Œå¹¶ç»™å°è£…äº†<code>subscribeCallback</code>è®¢é˜…å›è°ƒï¼Œ<code>isAuthorized</code><strong>é‰´æƒæ ¡éªŒ</strong>ï¼Œ<code>handler</code>æ¶ˆæ¯å®šå‘å‘é€ç­‰ç­‰å‡½æ•°ï¼Œè§„èŒƒæ¶ˆæ¯å¤„ç†çš„é€»è¾‘åŠæä¾›ä¸€äº›é€šç”¨çš„æ–¹æ³•ã€‚</p><p>ä¸ºäº†æ›´å¥½çš„ä¸ºä¸šåŠ¡å¤„ç†ç±»æœåŠ¡ï¼Œç»§ç»­æŠ½å–ä¸€å±‚<code>AbstractBusinessMessageHandler</code>ï¼Œå°è£…ä¸šåŠ¡ç›¸å…³çš„è¿”å›å¯¹è±¡ç»“æ„ä½“ï¼Œ<strong>jwté‰´æƒ</strong>ï¼Œè®¢é˜…æ•°æ®æ ¡éªŒç­‰ç­‰é€»è¾‘ï¼Œä»¥ä¿è¯<code>AbstractSocketMessageHandler</code>çš„&quot;çº¯æ´&quot;ï¼Œæ‰€ä»¥æœ€ç»ˆä¸šåŠ¡æ¶ˆæ¯å¤„ç†ç±»ç»§æ‰¿è‡ª<code>AbstractBusinessMessageHandler</code>ã€‚</p><h3 id="æ•°æ®äº¤äº’æ—¶åºè®¾è®¡" tabindex="-1">æ•°æ®äº¤äº’æ—¶åºè®¾è®¡ <a class="header-anchor" href="#æ•°æ®äº¤äº’æ—¶åºè®¾è®¡" aria-label="Permalink to &quot;æ•°æ®äº¤äº’æ—¶åºè®¾è®¡&quot;">â€‹</a></h3><p><img src="'+k+'" alt="æ•°æ®äº¤äº’æ—¶åºè®¾è®¡"></p><p>WebSocketæœåŠ¡æ•°æ®äº¤äº’çš„ç”Ÿæˆå‘¨æœŸä¸»è¦åŒ…æ‹¬ï¼šå»ºç«‹è¿æ¥<sup>@OnOpen</sup>ï¼ˆå…³é—­è¿æ¥<sup>@OnClose</sup>ï¼‰ï¼Œè®¢é˜…ä¸»é¢˜ï¼ˆå–æ¶ˆè®¢é˜…ï¼‰<sup>@OnMessage</sup>ï¼Œæ¶ˆæ¯æ¨é€ä¸‰å¤§éƒ¨åˆ†ï¼Œè€Œ<strong>é‰´æƒæ ¡éªŒ</strong>è¿™ä¸ªæ­¥éª¤åˆ™æ”¾åœ¨å»ºç«‹è¿æ¥çš„è¿‡ç¨‹ä¸­ã€‚</p><h3 id="é‰´æƒè®¾è®¡" tabindex="-1">é‰´æƒè®¾è®¡ <a class="header-anchor" href="#é‰´æƒè®¾è®¡" aria-label="Permalink to &quot;é‰´æƒè®¾è®¡&quot;">â€‹</a></h3><p><img src="'+t+`" alt="é‰´æƒè®¾è®¡"></p><p>å› ä¸ºWebSocketæœåŠ¡å’ŒWebæœåŠ¡åŒåŸŸï¼Œæ‰€ä»¥å‰ç«¯å¯ä»¥å°†WebæœåŠ¡è¯·æ±‚ä¸­çš„Cookieé€ä¼ åˆ°WebSocketè¿æ¥ä¸­ï¼Œå› æ­¤åç«¯ä¹Ÿå°±èƒ½å¤Ÿæ‹¿åˆ°<strong>Cookieä¸­çš„ctgtè¿›è¡Œjwté‰´æƒ</strong>ï¼Œä»¤ç‰Œæ ¡éªŒé€šè¿‡ä¹‹åæ¥å£ä¼šåŒæ­¥è¿”å›<code>userId</code>ï¼Œè¿™æ ·ç”¨æˆ·æ ‡è¯†å’ŒWebSocketçš„<code>Session</code>ä¹Ÿå°±åŒæ­¥å»ºç«‹èµ·äº†å…³è”ã€‚</p><p>è€Œå…¶ä¸­æ¶‰åŠçš„æ¥å£å’ŒæŠ€æœ¯ä»‹ç»å¯å‚è€ƒwiki <a href="https://wiki.hikvision.com.cn/pages/viewpage.action?pageId=148977420" target="_blank" rel="noreferrer">19ã€(aries)å®‰å…¨é˜²æŠ¤è®¤è¯Tokenï¼šaries-jc-jwt</a>ã€‚</p><h2 id="ğŸŒ³æºç æ¢ç©¶" tabindex="-1">ğŸŒ³æºç æ¢ç©¶ <a class="header-anchor" href="#ğŸŒ³æºç æ¢ç©¶" aria-label="Permalink to &quot;ğŸŒ³æºç æ¢ç©¶&quot;">â€‹</a></h2><h3 id="å¯åŠ¨é…ç½®ç±»" tabindex="-1">å¯åŠ¨é…ç½®ç±» <a class="header-anchor" href="#å¯åŠ¨é…ç½®ç±»" aria-label="Permalink to &quot;å¯åŠ¨é…ç½®ç±»&quot;">â€‹</a></h3><p>è¿™ä¸ªç±»æ ¸å¿ƒåŠŸèƒ½å³æ„é€ <code>ServerEndpointExporter</code> Beanå¯¹è±¡ï¼Œä»¥æ‰«ææ³¨å†Œå¸¦æœ‰<code>@ServerEndpoint</code>æ³¨è§£å£°æ˜çš„WebSocketæ¶ˆæ¯å¤„ç†ç±»ã€‚</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * websocket é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@author</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> yuanzp</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * @date 2022/12/1 15:10</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * @digression done is better than perfect.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Configuration</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ConditionalOnProperty</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">prefix</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> WebSocketServerProperties.PREFIX,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;enable&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">havingValue</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;true&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">EnableConfigurationProperties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({WebSocketServerProperties.class})</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WebSocketServerAutoConfiguration</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Autowired</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> WebSocketServerProperties config;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * å¼€å¯WebSocketæ”¯æŒ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * è¿™ä¸ªBeanä¼šè‡ªåŠ¨æ³¨å†Œä½¿ç”¨{@link ServerEndpoint}æ³¨è§£å£°æ˜çš„websocket endpoint</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@return</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Bean</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ConditionalOnMissingBean</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ServerEndpointExporter </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">serverEndpointExporter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ServerEndpointExporter serverEndpointExporter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ServerEndpointExporter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (config.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isPrintBanner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            LOGOPrinter.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> serverEndpointExporter;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="é‰´æƒæŠ½è±¡æ–¹æ³•" tabindex="-1">é‰´æƒæŠ½è±¡æ–¹æ³• <a class="header-anchor" href="#é‰´æƒæŠ½è±¡æ–¹æ³•" aria-label="Permalink to &quot;é‰´æƒæŠ½è±¡æ–¹æ³•&quot;">â€‹</a></h3><p>åœ¨æ¶ˆæ¯å¤„ç†æŠ½è±¡ç±»ä¸­ç»Ÿä¸€å¤„ç†<code>onOpen</code>è¿æ¥ç›¸å…³é€»è¾‘ï¼Œå¹¶ä¸”å®šä¹‰äº†<code>boolean isAuthorized(Session session)</code>é‰´æƒæ ¡éªŒæŠ½è±¡æ–¹æ³•ï¼Œç„¶ååœ¨å»ºç«‹è¿æ¥çš„æ—¶å€™è°ƒç”¨åˆ¤æ–­æ­¤è¿æ¥æ˜¯å¦æœ‰æ•ˆã€‚æ ¸å¿ƒä»£ç é€»è¾‘å¦‚ä¸‹ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * æ£€æŸ¥å®¢æˆ·ç«¯æ¡æ‰‹æ•°æ®æ˜¯å¦è¢«æˆæƒ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> session</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@return</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> abstract</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> boolean</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> isAuthorized</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Session session);</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * è¿æ¥å»ºç«‹æˆåŠŸè°ƒç”¨çš„æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OnOpen</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onOpen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Session session) throws IOException {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	LOG.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Connect OK,Session ID : {}.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, session.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isAuthorized</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(session)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		LOG.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;The client is not authorized,Session ID : {}.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, session.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		sendMessageByClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(session, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;The client is not authorized!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		session.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">close</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.session </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> session;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	RoomUtil.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(session);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	sendMessageByClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(session, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Welcome to the Jungle!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="é‰´æƒå®ç°é€»è¾‘" tabindex="-1">é‰´æƒå®ç°é€»è¾‘ <a class="header-anchor" href="#é‰´æƒå®ç°é€»è¾‘" aria-label="Permalink to &quot;é‰´æƒå®ç°é€»è¾‘&quot;">â€‹</a></h3><p>ä¸Šé¢è®²åˆ°äº†é‰´æƒçš„æŠ½è±¡æ–¹æ³•ï¼Œæ¥ä¸‹æ¥çœ‹ä¸‹è¯¥æŠ½è±¡æ–¹æ³•åœ¨ä¸šåŠ¡æ¶ˆæ¯å¤„ç†æŠ½è±¡ç±»ä¸­çš„å…·ä½“å®ç°é€»è¾‘ï¼Œå…¶ä¸­ä¸»è¦æ ¸å¿ƒå°±æ˜¯ä»<code>Session::getUserProperties</code>ä¸­è·å–<code>castgc</code>ï¼ˆ<em>é‚£ä¹ˆè¿™ä¸ªå‚æ•°æ˜¯åœ¨å“ªå„¿å†™å…¥çš„å‘¢ï¼Ÿï¼Ÿï¼Ÿ</em>ï¼‰ï¼Œä¹‹åè°ƒç”¨<code>jwtService.applyCT(castgc)</code>å’Œ<code>jwtService.checkCT(ct)</code>ä¸¤ä¸ªæ–¹æ³•è¿›è¡Œé‰´æƒã€‚</p><p>å¦å¤–éœ€è¦å¼ºè°ƒçš„æ˜¯<code>JwtService</code>çš„æ³¨å…¥æ–¹å¼æœ‰ç‚¹ç‰¹æ®Šï¼Œéœ€è¦å°†å˜é‡å®šä¹‰ä¸º<code>static</code>ï¼Œè¿™ä¹ˆåšçš„åŸå› æ˜¯WebSocketæ¯æ¬¡å»ºç«‹è¿æ¥çš„æ—¶å€™éƒ½ä¼š<code>new</code>ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¦‚æœä¸æ˜¯é™æ€å˜é‡ï¼Œé‚£ä¸ªåœ¨å»ºç«‹è¿æ¥æ—¶å€™å¿…å®šä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</p><p>å¦å¤–è¿˜å¢åŠ äº†ä¸€ä¸ª<code>devMode</code>å¼€å‘è€…æ¨¡å¼å¼€å…³ï¼Œæ–¹ä¾¿æœ¬åœ°å¼€å‘è”è°ƒã€‚æ ¸å¿ƒä»£ç é€»è¾‘å¦‚ä¸‹ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * ä¸šåŠ¡æ¶ˆæ¯å¤„ç†æŠ½è±¡ç±»ï¼Œä¸»è¦æŠ½å–å¤–å±‚é€šç”¨çš„ {@link BaseResult} å’Œ {@link MessageDTO} ï¼Œ&lt;br/&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * ä¿è¯{@link AbstractSocketMessageHandler}çš„çº¯æ´~&lt;br/&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * é™¤æ­¤ä»¥å¤–ï¼Œæä¾›å’Œä¸šåŠ¡â€˜å˜»å˜»â€™ç›¸å…³çš„èƒ½åŠ›ï¼šjc jwté‰´æƒ{</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@link</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">isAuthorized(Session)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">}ï¼Œç”¨æˆ·ä¿¡æ¯å­˜å‚¨{</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@link</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">setSessionStore(Session, String, Object)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">}ï¼Œé€šç”¨è®¢é˜…å›è°ƒå¤±è´¥å¤„ç†{</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@link</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">subscribeCallbackError(Session, SubscribeDTO, Exception)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">}ç­‰ç­‰ã€‚</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@author</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> yuanzp</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * @date 2022/12/8 10:28</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * @digression done is better than perfect.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Slf4j</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> abstract</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AbstractBusinessMessageHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">P</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">M</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AbstractSocketMessageHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">P</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, BaseResult&lt;MessageDTO&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">M</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt;&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String USER_KEY </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;user&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JwtService jwtService;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Boolean devMode;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Autowired</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AbstractBusinessMessageHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(JwtService </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">jwtService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                               @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;\${cvalarm.websocket.mode.dev:false}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) Boolean </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">devMode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        AbstractBusinessMessageHandler.jwtService </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jwtService;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        AbstractBusinessMessageHandler.devMode </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> devMode;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> boolean</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> isAuthorized</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Session </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        String castgc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Optional.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ofNullable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(session).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Session</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">getUserProperties)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(map </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> map.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WebSocketServerEndpointConfig.AUTHORIZATION_PARAM)).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(String</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">valueOf).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">orElse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (devMode) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            setUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(session, Constant.ADMIN_USER);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (StrUtil.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isBlank</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(castgc)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;JWT ct is blank.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        String userId;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            String ct </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jwtService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">applyCT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(castgc);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            userId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jwtService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">checkCT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ct);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (AuthorizationException </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;JWT checkCT error.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, e);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (StrUtil.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isBlank</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userId)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;JWT checkCT return null.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        setUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(session, userId);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="cookieå‚æ•°è§£æ" tabindex="-1">Cookieå‚æ•°è§£æ <a class="header-anchor" href="#cookieå‚æ•°è§£æ" aria-label="Permalink to &quot;Cookieå‚æ•°è§£æ&quot;">â€‹</a></h3><p>è§£ç­”ä¸‹ä¸Šé¢æåˆ°çš„<code>Session::getUserProperties</code>ä¸­<code>castgc</code>æ•°æ®æ¥æºé—®é¢˜ï¼Œè¿™é‡Œéœ€è¦è‡ªå®šå®ç°ä¸€ä¸ª<code>ServerEndpointConfig.Configurator</code>ç”¨ä»¥è§£æCookieä¸­çš„<code>castgc</code>ï¼Œæ ¸å¿ƒä»£ç é€»è¾‘å¦‚ä¸‹ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * è‡ªå®šä¹‰endpoint</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@author</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> yuanzp</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * @date 2022/12/14 20:25</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * @digression done is better than perfect.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Slf4j</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WebSocketServerEndpointConfig</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ServerEndpointConfig.Configurator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String AUTHORIZATION_PARAM </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CASTGC&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> modifyHandshake</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ServerEndpointConfig </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, HandshakeRequest </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, HandshakeResponse </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Map&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; userProperties </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sec.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getUserProperties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Map&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; headers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> request.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getHeaders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Assert.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">notNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userProperties);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Assert.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">notNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(headers);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        String token </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Optional.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ofNullable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Cookies.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parseRequestCookies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">250</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, headers.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Headers.COOKIE.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(map</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">map.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(AUTHORIZATION_PARAM)).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Cookie</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">getValue).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">orElse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        userProperties.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">put</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(AUTHORIZATION_PARAM, token);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>è€Œæ­¤å¤„Cookieçš„è§£æé€»è¾‘å‚è€ƒè‡ªSpring<code>@CookieValue</code>æ³¨è§£çš„æºä»£ç <code>ServletCookieValueMethodArgumentResolver</code>ï¼Œå› æ­¤å¤§å¤§ç®€åŒ–äº†Cookieçš„è§£æè¿‡ç¨‹ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯è‡ªè¡ŒæŸ¥çœ‹ã€‚</p><h3 id="æ¶ˆæ¯å¤„ç†ç±»" tabindex="-1">æ¶ˆæ¯å¤„ç†ç±» <a class="header-anchor" href="#æ¶ˆæ¯å¤„ç†ç±»" aria-label="Permalink to &quot;æ¶ˆæ¯å¤„ç†ç±»&quot;">â€‹</a></h3><p>å¯¹äºå…·ä½“çš„ä¸šåŠ¡æ¶ˆæ¯å¤„ç†ç±»æ¥è¯´ï¼Œé‰´æƒçš„é€»è¾‘å‡ ä¹å°±æ˜¯é€æ˜çš„ï¼Œåœ¨<code>@ServerEndpoint</code>æ³¨è§£ä¸ŠåŠ ä¸Šè‡ªå®šä¹‰çš„<code>WebSocketServerEndpointConfig</code>ï¼Œé™¤æ­¤ä»¥å¤–ä¸éœ€è¦åšä»»ä½•çš„æ“ä½œï¼Œå³å¯è½»æ¾å®ç°é‰´æƒã€‚</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * æ‰§æ³•åŠ›é‡ï¼ˆAPPï¼‰å¤„ç†ç±»ï¼Œæ”¯æŒçš„GPSæ•°æ®ç±»å‹è¯¦è§ {@link GpsDeviceClassEnum}ï¼ŒTopicä¸»é¢˜å¤ç”¨æ­¤èµ„æºç±»å‹ã€‚</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@author</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> yuanzp</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * @date 2022/12/1 15:28</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * @digression done is better than perfect.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Slf4j</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Component</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ServerEndpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MobileDeviceHandler.SERVER_ENDPOINT, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">encoders</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> WebSocketCustomEncoding.class,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        configurator</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> WebSocketServerEndpointConfig.class)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MobileDeviceHandler</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AbstractBusinessMessageHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">MobileDeviceMessageDTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String SERVER_ENDPOINT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/ws/MOBILE_DEVICE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> XmapGpsService xmapGpsService;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Autowired</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setXmapGpsService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(XmapGpsService </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">xmapGpsService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        MobileDeviceHandler.xmapGpsService </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xmapGpsService;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Boolean </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">validatedSubscribeParam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(SubscribeDTO&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        String topic </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getTopic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        MobileDeviceTopicEnum mobileDeviceTopicEnum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MobileDeviceTopicEnum.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">valueOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(topic);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ObjectUtil.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isNotNull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mobileDeviceTopicEnum);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    protected</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> subscribeCallback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Session </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, SubscribeDTO&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        super</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">subscribeCallback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(session, message);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        String topic </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getTopic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        GpsDeviceClassEnum gpsDeviceClassEnum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EnumUtil.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">likeValueOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(GpsDeviceClassEnum.class, topic);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">MobileDeviceMessageDTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; mobileDeviceMessageDTOS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xmapGpsService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">queryRealGpsDevice</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gpsDeviceClassEnum);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        MessageDTO&lt;List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">MobileDeviceMessageDTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; messageDTO </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createMessageBean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(topic, mobileDeviceMessageDTOS);</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        super</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sendBusinessMessageToTopicRoomClients</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(messageDTO);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> businessProcessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">topic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">MobileDeviceMessageDTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">messageObj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="ğŸŒ¿ç»“æœéªŒè¯" tabindex="-1">ğŸŒ¿ç»“æœéªŒè¯ <a class="header-anchor" href="#ğŸŒ¿ç»“æœéªŒè¯" aria-label="Permalink to &quot;ğŸŒ¿ç»“æœéªŒè¯&quot;">â€‹</a></h2><p>æœ¬æ¬¡WebSocketä½¿ç”¨&quot;<a href="https://toscode.gitee.com/wuyazi2018/WebsocketMan" target="_blank" rel="noreferrer">WebSocketMan</a>&quot;å®¢æˆ·ç«¯å·¥å…·è¿›è¡Œæµ‹è¯•ï¼Œç»“æœä¸»è¦ä»å®¢æˆ·ç«¯è¿æ¥æ‰“å°ä»¥åŠæœåŠ¡ç«¯æ—¥å¿—ä¸¤æ–¹é¢è¿›è¡ŒéªŒè¯ã€‚</p><h3 id="é‰´æƒå¤±è´¥" tabindex="-1">é‰´æƒå¤±è´¥ <a class="header-anchor" href="#é‰´æƒå¤±è´¥" aria-label="Permalink to &quot;é‰´æƒå¤±è´¥&quot;">â€‹</a></h3><p>å½“Headersä¸­ä¸ä¼ Cookieï¼ˆæˆ–è€…ä¼ é”™è¯¯çš„CASTGCï¼‰è¿›è¡Œè¿æ¥æ—¶ï¼Œä¼šæç¤ºé‰´æƒå¤±è´¥å¹¶ä¸”åŒæ—¶å…³é—­è¿æ¥ã€‚</p><p><img src="`+l+`" alt="é‰´æƒå¤±è´¥"></p><div class="language-less vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">less</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">2022-12-28T09:40:11</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.687</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+08:00 DEBUG cvalarm</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.cvalarm-data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">XNIO-1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> task-1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">com</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hikvision</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pbg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cvalarm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">modules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">socket</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AbstractSocketMessageHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:101]   - Connect OK,Session ID : R11_JEbNzwcE3gEig52tUppLmkb7cWdW1H17wQZr</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">2022-12-28T09:40:11</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.691</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+08:00 ERROR cvalarm</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.cvalarm-data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">XNIO-1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> task-1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pbg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cvalarm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">modules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">websocket</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">handler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AbstractBusinessMessageHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:87]   - JWT ct is blank</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">2022-12-28T09:40:11</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.712</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+08:00 DEBUG cvalarm</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.cvalarm-data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">XNIO-1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> task-1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">com</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hikvision</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pbg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cvalarm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">modules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">socket</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AbstractSocketMessageHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:103]   - The client is not authorized,Session ID : R11_JEbNzwcE3gEig52tUppLmkb7cWdW1H17wQZr</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">2022-12-28T09:40:11</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.729</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+08:00 DEBUG cvalarm</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.cvalarm-data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">XNIO-1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> task-1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">com</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hikvision</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pbg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cvalarm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">modules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">socket</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AbstractSocketMessageHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:118]   - Disconnect OK,Session ID : R11_JEbNzwcE3gEig52tUppLmkb7cWdW1H17wQZr</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.</span></span></code></pre></div><h3 id="é‰´æƒæˆåŠŸ" tabindex="-1">é‰´æƒæˆåŠŸ <a class="header-anchor" href="#é‰´æƒæˆåŠŸ" aria-label="Permalink to &quot;é‰´æƒæˆåŠŸ&quot;">â€‹</a></h3><p>ç™»å½•é—¨æˆ·å¹³å°ï¼ŒF12æŸ¥çœ‹è¯·æ±‚Request Headersï¼Œå¹¶ä¸”æ‹·è´Cookieå‚æ•°è¿›è¡Œæµ‹è¯•éªŒè¯ã€‚ä¸€æ—¦é‰´æƒé€šè¿‡ï¼ŒåŠä¼šæç¤ºè¿æ¥æˆåŠŸã€‚</p><blockquote><p><strong>ğŸ“£æ³¨æ„</strong></p><p>è®°å¾—å°†/ws/**è¯·æ±‚å¢åŠ caså¿½ç•¥ï¼Œå¦åˆ™å¯èƒ½å­˜åœ¨é¦–æ¬¡è®¿é—®æ— æ³•åŠ è½½é—®é¢˜ã€‚</p></blockquote><p><img src="`+p+'" alt="é—¨æˆ·è·å–Cookie"></p><p><img src="'+e+'" alt="é‰´æƒæˆåŠŸ"></p><div class="language-less vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">less</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">2022-12-28T09:44:27</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.809</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">+08:00 DEBUG cvalarm</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.cvalarm-data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">XNIO-1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> task-1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">com</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hikvision</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pbg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cvalarm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">modules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">socket</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AbstractSocketMessageHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:101]   - Connect OK,Session ID : 2kdUmtSylRbkRZNcELAVXrpM4QlJVdjKl-te2ZPP</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.</span></span></code></pre></div><h2 id="ğŸŒ¼ç»“æŸè¯­" tabindex="-1">ğŸŒ¼ç»“æŸè¯­ <a class="header-anchor" href="#ğŸŒ¼ç»“æŸè¯­" aria-label="Permalink to &quot;ğŸŒ¼ç»“æŸè¯­&quot;">â€‹</a></h2><p>æœ‰ç¼˜çœ‹åˆ°è¿™ç¯‡åˆ†äº«çš„å°ä¼™ä¼´ï¼Œå¦‚æœä¸Šæ–‡æè¿°ä¸­æœ‰ä¸å¦¥å½“æˆ–é”™è¯¯çš„åœ°æ–¹è¿˜æ³è¯·æŒ‡æ­£ï¼Œæœ€åå¸Œæœ›åœ¨WebSocketé‰´æƒæ–¹é¢ç»™ä½ å¸¦å»äº†ä¸€ç‚¹å¯å‘å’Œå‚è€ƒã€‚</p><p>æœ€åçš„æœ€åï¼Œç¥ä½ æ–°å¹´å¿«ä¹ğŸ‰ï¼Œç›†å‹~<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup></p><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>JSON Web Tokenï¼ˆJWTï¼‰æ˜¯ä¸€ä¸ªå¼€æ”¾æ ‡å‡†(RFC 7519)ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§ç´§å‡‘çš„ã€è‡ªåŒ…å«çš„æ–¹å¼ï¼Œç”¨äºä½œä¸ºJSONå¯¹è±¡åœ¨å„æ–¹ä¹‹é—´å®‰å…¨åœ°ä¼ è¾“ä¿¡æ¯ï¼Œæ˜¯ç›®å‰æœ€æµè¡Œçš„è·¨åŸŸèº«ä»½éªŒè¯è§£å†³æ–¹æ¡ˆã€‚ <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p></li><li id="fn2" class="footnote-item"><p>åŸºäºNettyæ¡†æ¶ï¼Œä½¿ç”¨Javaè¯­è¨€å®ç°çš„ä¸€å¥—Socket.IOæœåŠ¡å™¨ç«¯é€šä¿¡å·¥å…·ã€‚ <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p></li><li id="fn3" class="footnote-item"><p>â€œç”Ÿæ´»æ²¡æœ‰é‚£ä¹ˆçš„ç¾å¥½ï¼Œä¹Ÿæ²¡æœ‰é‚£ä¹ˆç³Ÿç³•ã€‚â€---created by è¢å¿—é¹ on åäºŒæœˆ 20,2022ï¼›last edited by è¢å¿—é¹ on åäºŒæœˆ 29,2022 <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p></li></ol></section>',59),d=[r];function g(y,o,c,F,A,D){return a(),i("div",null,d)}const b=s(E,[["render",g]]);export{u as __pageData,b as default};
