import{_ as s,c as i,o as a,a4 as n}from"./chunks/framework.CUMjAKNJ.js";const l="/yzp-blog/assets/%E5%AA%92%E4%BD%93%E7%9B%B8%E5%85%B3%E7%BB%84%E4%BB%B6.eHRdTKWg.png",p="/yzp-blog/assets/%E5%AE%9E%E6%97%B6%E9%A2%84%E8%A7%88%E6%A1%86%E6%9E%B6.qF_UrprA.png",h="/yzp-blog/assets/%E5%AE%9E%E6%97%B6%E9%A2%84%E8%A7%88%E6%97%B6%E5%BA%8F.BiitP_Wk.png",k="/yzp-blog/assets/%E5%BD%95%E5%83%8F%E5%9B%9E%E6%94%BE%E6%A1%86%E6%9E%B6.scnWF_yb.png",t="/yzp-blog/assets/%E5%BD%95%E5%83%8F%E5%9B%9E%E6%94%BE%E6%97%B6%E5%BA%8F.ChP20b_R.png",e="/yzp-blog/assets/%E8%AE%BE%E5%A4%87%E5%AD%98%E5%82%A8%E5%BD%95%E5%83%8F%E8%AE%A1%E5%88%92.D1DH5OEo.png",r="/yzp-blog/assets/%E4%B8%AD%E5%BF%83%E5%AD%98%E5%82%A8%E5%BD%95%E5%83%8F%E8%AE%A1%E5%88%92.5WK1H4ju.png",E="/yzp-blog/assets/%E8%A7%86%E9%A2%91%E7%BA%A7%E8%81%94%E6%A1%86%E6%9E%B6.CLozPCZ8.png",d="/yzp-blog/assets/%E8%A7%86%E9%A2%91%E7%BA%A7%E8%81%94%E9%A2%84%E8%A7%88.D_r1ZWfi.png",g="/yzp-blog/assets/PMP%E5%B7%A5%E5%85%B7%E4%B8%8B%E8%BD%BD.CTOTmk_r.png",o="/yzp-blog/assets/ClientDemo%E6%95%88%E6%9E%9C.C6Q3HIh6.png",y="/yzp-blog/assets/SDK%E9%A2%84%E8%A7%88%E9%9B%86%E6%88%90%E6%B5%81%E7%A8%8B.D_CAc4Yp.png",c="/yzp-blog/assets/Java%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97.UhJ-9yZe.png",D="/yzp-blog/assets/%E8%A7%86%E9%A2%91%E9%A2%84%E8%A7%88%E7%AA%97%E5%8F%A3%E6%95%88%E6%9E%9C.BZyuDq7n.png",q=JSON.parse('{"title":"HIK视频相关知识备忘录","description":"","frontmatter":{},"headers":[],"relativePath":"工作点滴积累/HIK视频相关知识备忘录.md","filePath":"工作点滴积累/HIK视频相关知识备忘录.md"}'),F={name:"工作点滴积累/HIK视频相关知识备忘录.md"},A=n('<h1 id="hik视频相关知识备忘录" tabindex="-1">HIK视频相关知识备忘录 <a class="header-anchor" href="#hik视频相关知识备忘录" aria-label="Permalink to &quot;HIK视频相关知识备忘录&quot;">​</a></h1><h2 id="🍕-写在前面的话" tabindex="-1">🍕 写在前面的话 <a class="header-anchor" href="#🍕-写在前面的话" aria-label="Permalink to &quot;🍕 写在前面的话&quot;">​</a></h2><p>本文基于海康统一技术架构为基数进行视频类相关知识的介绍，其中包括一些基础视频知识，视频存储，视频媒体相关组件，平台设备接入协议，基础视频流程等内容。</p><p>除此以外，最后拓展科普一下海康HCNetSDK<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>相关的知识，这部分在一定程度上可以补充统一技术架构底层设备接入框架dac和设备之间的交互逻辑。</p><h2 id="🍔-视频基础知识" tabindex="-1">🍔 视频基础知识 <a class="header-anchor" href="#🍔-视频基础知识" aria-label="Permalink to &quot;🍔 视频基础知识&quot;">​</a></h2><p>大概介绍一下视频码流的一些概念知识，对视频基础知识感兴趣的盆友，可以直接参考附件中的”<strong>视频基础知识介绍.pptx</strong>“，或者通过嗨学相关课程进行学习。</p><p><strong>视频帧率</strong></p><p>帧率指的是在一秒钟内显示器显示的图像的帧数，单位为帧/秒(fps)，一副完整的视频画面为一帧。在高清视频监控中，常用的分辨率如1920×1080、1280 × 720，通常支持的最高帧率是25fps（<em>20fps到25fps</em>,）。</p><p><strong>视频码率</strong></p><p>视频码率就是数据传输时单位时间传送的数据位数，一般用的单位是kbps（千位每秒）或Mbps（百万位每秒）。相同画面下，码率越大，图像质量越好，码率越小，图像质量越差。</p><p>码率一般分定码率和变码率，应对不同的网络带宽环境和数据传输场景。</p><p><strong>视频编码</strong></p><p>所谓视频编码方式就是指通过压缩技术，将原始视频格式的文件转换成另一种视频格式文件的方式。</p><p>视频流传输中最为重要的编解码标准有国际电联的H.261、H.263、H.264，运动静止图像专家组的M-JPEG和国际标准化组织运动图像专家组的MPEG系列标准，此外在互联网上被广泛应用的还有Real-Networks的RealVideo、微软公司的WMV以及Apple公司的QuickTime等。</p><p>在视频监控领域，我们常说的H.264和H.265，指的即是视频编码格式。</p><p><strong>视频封装格式</strong></p><p>视频封装是将已经编码处理的视频数据、音频数据、字幕数据等按照一定的方式放到一个数据包中，这个文件的格式就是视频封装格式。</p><p>常见封装格式包括：PS、TS、FLV、RTP、GB/T 28181，应用在录像存储，数字电视，视频网站和监控视频等等场景。</p><h2 id="🧀-视频存储" tabindex="-1">🧀 视频存储 <a class="header-anchor" href="#🧀-视频存储" aria-label="Permalink to &quot;🧀 视频存储&quot;">​</a></h2><p>海康视频录像存储服务器主要包括：NVR，CVR，云存储三大类，ASW主要用于图片和视频文件的存储，无法用于流媒体存储。</p><h3 id="nvr" tabindex="-1">NVR <a class="header-anchor" href="#nvr" aria-label="Permalink to &quot;NVR&quot;">​</a></h3><p>NVR （Network Video Recorder）即网络视频录像机，是一种基于网络技术的视频监控设备。NVR与视频编码器或网络摄像机协同工作，它通过网络连接到 IP 摄像机（或网络摄像机），将摄像机传输过来的数字视频信号进行录制、播放、存储及转发。可以支持多个IP摄像机同时录制，而且通过网络可以远程访问和控制。</p><h3 id="cvr" tabindex="-1">CVR <a class="header-anchor" href="#cvr" aria-label="Permalink to &quot;CVR&quot;">​</a></h3><p>CVR（Central Video Recorder）即中心级视频网络存储设备，它是由标准的IPSAN/NAS网络存储设备，结合视频监控应用发展而来。CVR是集编码设备管理、录像管理、存储、转发功能为一体的视频专用存储技术。</p><h3 id="云存储" tabindex="-1">云存储 <a class="header-anchor" href="#云存储" aria-label="Permalink to &quot;云存储&quot;">​</a></h3><p>云存储（<em>题外话：找了一圈楞是没找到简称，HikCloud Storage???Advanced Cloud Video Storage???</em>）是基于云计算技术建立起来的一个网络存储技术，将网络中的不同设备通过应用程序连接起来，进行协同工作，对外提供数据存储和业务访问。因此云存储即具备资源虚拟化，集群部署，负载均衡，容灾备份等“云”特性。</p><p>海康云存储支持单机云、微视云和标准云三种方案，可以应对不同的应用场景规模，支持视频存储、图片存储、对象存储和文件存储，同时具备一定的扩展性，支持异构第三方存储。</p><h3 id="asw-pstor" tabindex="-1">ASW（pStor） <a class="header-anchor" href="#asw-pstor" aria-label="Permalink to &quot;ASW（pStor）&quot;">​</a></h3><p>ASW（Access Storage for Windows）即存储接入服务，为统一架构平台中的存储组件，提供小规模场景下（5TB以下）的流式图片和视频片段的存储能力，不支持视频录像、对象存储，不支持rose热备，不支持异构三方存储。</p><blockquote><p><strong>📌 pStor与ASW关系</strong></p><p>pStor（<em>题外话：这里的’p‘表示什么？？？希望知道的胸弟补充。</em>）是一款针对海外市场提供实时流录像功能的单机windows存储软件，pStor和ASW是一套svn代码管理，生成不同系统架构的成果物，分别用在国内和海外业务，侧重不同的存储功能。</p></blockquote><h3 id="存储异构" tabindex="-1">存储异构 <a class="header-anchor" href="#存储异构" aria-label="Permalink to &quot;存储异构&quot;">​</a></h3><p>视频异构存储软件提供第三方存储设备接入能力，为上层行业应用平台，提供与视频云存储相同接口，实现无感对接应用服务。具体这一块的知识点可以通过“<a href="https://hls.hikvision.com/#/courseDetail?lessonCode=2023030800101&amp;lessonId=24449&amp;t=1" target="_blank" rel="noreferrer">视频云存储异构方案介绍</a><sup>嗨学</sup>”课程进行更深入的了解和学习。</p><h2 id="🍟-媒体相关组件" tabindex="-1">🍟 媒体相关组件 <a class="header-anchor" href="#🍟-媒体相关组件" aria-label="Permalink to &quot;🍟 媒体相关组件&quot;">​</a></h2><p>海康统一技术构架中，设备管理，接入，预览/回放和运维等有一套通用的视频媒体组件，主要包括：物联设备管理 （sdmc），设备接入框架（dac），视频联网共享（vnsc），媒体网关（mgc），存储接入（sac），视频点播（vod），视频联网网关（ncg），设备探针接入框架（paf）和视频网管（nms）。</p><p><img src="'+l+'" alt="image-20240227105221551"></p><h3 id="物联设备管理-sdmc" tabindex="-1">物联设备管理 - sdmc <a class="header-anchor" href="#物联设备管理-sdmc" aria-label="Permalink to &quot;物联设备管理 - sdmc&quot;">​</a></h3><p>设备管理主要定位于统一的设备接入和管理，通过预置+扩展方式，为各个产品线提供各种类型设备的接入、管理、数据采集配置能力。</p><h3 id="视频联网共享-vnsc" tabindex="-1">视频联网共享 - vnsc <a class="header-anchor" href="#视频联网共享-vnsc" aria-label="Permalink to &quot;视频联网共享 - vnsc&quot;">​</a></h3><p>全域媒体服务管理调度，专注于平台视频应用调度，集成媒体调度资源的统一管理，屏蔽视频取流调度的差异化对接，针对视频取流应用场景（包括预览、下载、对讲、本级取流、跨域取流等基础视频业务），提供合理、高效的视频调度服务，包括负载均衡和智能控制。</p><h3 id="设备接入框架-dac" tabindex="-1">设备接入框架 - dac <a class="header-anchor" href="#设备接入框架-dac" aria-label="Permalink to &quot;设备接入框架 - dac&quot;">​</a></h3><p>专注于物联设备接入，通过统一设备物模型以及驱动可扩展方式提供了可支撑各类不同协议设备接入的统一框架服务，同时对外提供统一接口用于应用集成调用，对上屏蔽设备取流差异性。</p><h3 id="媒体网关-mgc" tabindex="-1">媒体网关 - mgc <a class="header-anchor" href="#媒体网关-mgc" aria-label="Permalink to &quot;媒体网关 - mgc&quot;">​</a></h3><p>实现码流多线路、转分发、转码等功能，主要应用于大分发场景，专注于标准协议对接（与Client之间），提供转码服务和跨域服务，作为安全隔离和音视频码流转换网关。</p><h3 id="存储接入-sac" tabindex="-1">存储接入 - sac <a class="header-anchor" href="#存储接入-sac" aria-label="Permalink to &quot;存储接入 - sac&quot;">​</a></h3><p>统一接入多类型海康威视中心存储设备，屏蔽存储差异，对中心存储设备进行管理、调度，为上层应用提供池化服务，开放存储流式和对象服务，可关联存储管理平台扩展行业平台存储场景化业务。提供视频录像计划配置、下发、启停和删除，录像锁定和解锁，录像查询等功能。</p><h3 id="视频点播-vod" tabindex="-1">视频点播 - vod <a class="header-anchor" href="#视频点播-vod" aria-label="Permalink to &quot;视频点播 - vod&quot;">​</a></h3><p>专注与中心存储的录像回放业务，包括录像正放、录像倒放、暂停恢复、拖动定位、倍速恢复、录像下载等，屏蔽对多种中心存储设备取流的差异，支持向云存储，CVR， PCNVR等中心存储设备获取码流并转发录像视频到终端。支持服务器独立部署或者部署云存储服务器内。</p><h3 id="视频联网网关-ncg" tabindex="-1">视频联网网关 - ncg <a class="header-anchor" href="#视频联网网关-ncg" aria-label="Permalink to &quot;视频联网网关 - ncg&quot;">​</a></h3><p>专注于平台域间视频联网（级联），基于标准协议与外域平台互联互通，支持视频通用标准协议（GB/T28181-2011,GB/T28181-2016,DB33/T629-2011）、以及行业视频标准协议。主要业务功能包括：域间注册与心跳、资源同步、实时预览、录像回放与控制、录像下载、语音广播、设备控制等。</p><h3 id="设备探针接入框架-paf" tabindex="-1">设备探针接入框架 - paf <a class="header-anchor" href="#设备探针接入框架-paf" aria-label="Permalink to &quot;设备探针接入框架 - paf&quot;">​</a></h3><p>直连设备探针通过与前端设备，存储设备以及各个接入组件交互。通过网络检测，信令交互，业务流程模拟来提供对平台内设备，服务是否在线，功能正常，基本信息的定时检测。还包括视频质量，码流信息的检测等功能，为上层业务提供基础的检测数据。</p><h3 id="视频网管-nms" tabindex="-1">视频网管 - nms <a class="header-anchor" href="#视频网管-nms" aria-label="Permalink to &quot;视频网管 - nms&quot;">​</a></h3><p>面向各行业提供视频设备巡检的能力，通过自动化巡检策略，对设备的运行状态进行实时监测，减少人工巡检工作量。</p><h2 id="🍿-设备接入协议" tabindex="-1">🍿 设备接入协议 <a class="header-anchor" href="#🍿-设备接入协议" aria-label="Permalink to &quot;🍿 设备接入协议&quot;">​</a></h2><p><strong>海康设备网络SDK协议</strong></p><p>遵循海康威视设备网络软件开发工具包进行消息交互的协议。</p><p><strong>大华设备网络SDK协议</strong></p><p>遵循大华设备配套的软件开发工具包进行交互的协议。</p><p><strong>海康ISUP5.0协议</strong></p><p>遵循海康威视ISUP协议完成通信，对联网环境无特殊要求，固定IP和动态IP设备均可通过该协议主动向平台注册。</p><p><strong>海康EHome协议</strong></p><p>遵循海康威视EHome协议完成通信，对联网环境无特殊要求，固定IP和动态IP设备均可通过该协议主动向平台注册。</p><p><strong>GB28181协议</strong></p><p>遵循中国国家标准（GB/T28181）《安全防范视频监控联网系统信息传输、交换、控制技术要求》要求的通讯协议。</p><p><strong>Open Network Video Interface协议</strong></p><p>开放型网络视频接口论坛（Open Network Video Interface Forum）共同制定的开放性行业标准。</p><p><strong>萤石协议</strong></p><p>遵循海康威视萤石开放服务开发工具包进行消息交互的协议。</p><h2 id="🌭-基础视频流程" tabindex="-1">🌭 基础视频流程 <a class="header-anchor" href="#🌭-基础视频流程" aria-label="Permalink to &quot;🌭 基础视频流程&quot;">​</a></h2><p>这个章节将大概介绍一下基于统一技术架构产品平台实现视频的实时预览，录像回放和录像计划内部的取流流程，以及平台之间基于GB28181国标协议级联取流流程。</p><h3 id="实时预览" tabindex="-1">实时预览 <a class="header-anchor" href="#实时预览" aria-label="Permalink to &quot;实时预览&quot;">​</a></h3><p>实时预览涉及的组件包括：<code>dac设备接入框架</code>，<code>vnsc视频联网共享</code>和<code>mgc媒体网关</code>。</p><blockquote><p><strong>📌 备注</strong></p><p>本章节只讨论过平台取流方式的实时预览流程，设备直接取流方式详见“[🧆 HCNetSDK工具](#🧆 HCNetSDK工具)”章节。</p></blockquote><p><img src="'+p+'" alt=""></p><p>过平台的取流流程大致如下：</p><ol><li>客户端发起预览请求，通过<code>vnsc视频联网共享</code>获取取流串（客户端获取的为取流短URL）；</li><li>然后通过取流串向<code>dac设备接入框架</code>取流；</li><li><code>dac设备接入框架</code>通过短URL向<code>vnsc视频联网共享</code>交换获取长URL，借此向IPC相机取流；</li><li>如果选择了过流媒体网关，那么码流通过<code>dac设备接入框架</code>之后，再通过<code>mgc媒体网关</code>返回给客户端；</li><li>客户端拿到码流之后，通过相应的解码库解码播放。</li></ol><p>详细的交互时序图如下。</p><p><img src="'+h+'" alt=""></p><h3 id="录像回放" tabindex="-1">录像回放 <a class="header-anchor" href="#录像回放" aria-label="Permalink to &quot;录像回放&quot;">​</a></h3><p>录像回放分设备存储和中心存储两种场景，设备存储主要包括NVR和设备SD存储卡，中心存储主要包括CVR和云存储。</p><p>因此两种录像回放取流流程有一定差异：设备存储的录像取流通过<code>dac设备接入框架</code>组件接入视频流，中心存储的录像取流则通过<code>vod视频点播</code>组件接入视频流。</p><p>而对于客户端发起取流相关的流程则是通用的，都是通过<code>sac存储接入</code>组件获取录像取流短URL，其中<code>mgc媒体网关</code>组件在视频取流中是一个可选项，当存在跨域多线路、标准对外，安全管控水印等需求时候，则可以考虑取流过媒体网关。</p><p><img src="'+k+'" alt=""></p><p>下图为中心存储录像回放的完整取流交互时序图，设备存储的取流时序基本一致，只需要将其中的<code>vod视频点播</code>修改成<code>dac设备接入框架</code>，<code>中心存储</code>修改为<code>设备存储</code>。</p><p><img src="'+t+'" alt=""></p><h3 id="录像计划" tabindex="-1">录像计划 <a class="header-anchor" href="#录像计划" aria-label="Permalink to &quot;录像计划&quot;">​</a></h3><p>首先在平台上预配置设备录像计划，录像计划主要分三种：设备存储，中心存储和录像回传，录像回传的流程和中心存储基本类似，所以接下来只介绍设备存储和中心存储两种方式。</p><p><strong>设备存储</strong></p><p>设备存储的录像计划下发流程如下：</p><ol><li><code>sac存储接入</code>组件向<code>dac设备接入框架</code>组件发送录像计划；</li><li><code>dac设备接入框架</code>组件通过设备协议向相应的前端设备请求设备录像；</li><li>前端设备根据录像计划进行码流转存。</li></ol><p><img src="'+e+'" alt=""></p><p><strong>中心存储</strong></p><p>中心存储的录像计划下发流程如下：</p><ol><li><code>sac存储接入</code>组件向<code>dac设备接入框架</code>组件发送录像计划；</li><li><code>dac设备接入框架</code>组件通过设备协议向相应的前端设备请求码流；</li><li>如果录像计划选择了过流媒体网关，那么码流通过<code>dac设备接入框架</code>之后，再通过<code>mgc媒体网关</code>返回给中心存储；</li><li>中心存储设备将推送的码流进行转存。</li></ol><p><img src="'+r+'" alt=""></p><h3 id="视频级联" tabindex="-1">视频级联 <a class="header-anchor" href="#视频级联" aria-label="Permalink to &quot;视频级联&quot;">​</a></h3><p>视频级联主要针对于平台之间视频联网共享，基于标准协议进行互联互通，一般常见的视频通用标准协议包括：GB/T28181-2011，GB/T28181-2016，DB33/T629-2011，以及行业视频标准协议。</p><p>实时预览涉及的组件包括：<code>vnsc视频联网共享</code>，<code>ncg视频联网网关</code>和<code>mgc媒体网关</code>。</p><p><img src="'+E+'" alt=""></p><p>级联视频预览流程如下：</p><ol><li>客户端发起预览请求，通过<code>vnsc视频联网共享</code>获取取流串</li><li><code>vnsc视频联网共享</code>向<code>ncg视频联网网关</code>获取设备信息，组装取流串短URL；</li><li>客户端根据取流短URL发起取流请求；</li><li><code>ncg视频联网网关</code>通过短URL向<code>vnsc视频联网共享</code>交换获取长URL，并且通过国标GB28181协议向下级取流；</li><li>如果选择了过流媒体网关，那么码流通过<code>ncg视频联网网关</code>之后，再通过<code>mgc媒体网关</code>返回给客户端；</li><li>客户端拿到码流之后，通过相应的解码库解码播放。</li></ol><p>详细的交互时序图如下。</p><p><img src="'+d+`" alt=""></p><h2 id="🧆-hcnetsdk工具" tabindex="-1">🧆 HCNetSDK工具 <a class="header-anchor" href="#🧆-hcnetsdk工具" aria-label="Permalink to &quot;🧆 HCNetSDK工具&quot;">​</a></h2><p><a href="http://pmp.hikvision.com.cn/#/SDK_VERSION/HCNetSDK" target="_blank" rel="noreferrer">HCNetSDK</a>是基于设备私有网络通信协议开发的，为嵌入式网络硬盘录像机、NVR、网络摄像机、网络球机、视频服务器、解码器、报警主机、网络存储等产品服务的配套模块，用于远程访问和控制设备软件的二次开发。</p><p>网络SDK主要功能包括：图像预览, 文件回放和下载, 云台控制, 布防/撤防, 语音对讲, 日志管理, 解码卡, 远程升级, 远程重启/关闭, 格式化硬盘, 参数配置(系统配置, 通道配置, 串口配置, 报警配置, 用户配置), 多路解码器, 智能设备功能和获取设备能力集等。</p><p>统一技术架构平台上如果选择海康设备网络SDK协议接入，设备接入框架dac对应驱动内部集成的即是HCNetSDK（<strong>注：平台客户端通过网络SDK直连取流同理</strong>）。而我在这儿以一个Java Demo为例子（对C++没啥研究😑），基于该工具视频预览进行简单的介绍。</p><h3 id="准备工作" tabindex="-1">准备工作 <a class="header-anchor" href="#准备工作" aria-label="Permalink to &quot;准备工作&quot;">​</a></h3><blockquote><p><strong>📌 备注</strong></p><ul><li><p>本机测试环境为Windows 10/64位操作系统；</p></li><li><p>JDK版本号：1.8.0_181-b13（ 64-Bit Server VM）；</p></li><li><p>HCNetSDK版本号：HCNetSDKV6.1.9.49_build20240117_Win64_ZH_demosign；</p></li><li><p>jna（jna-platform）版本：5.13.0；</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;net.java.dev.jna&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;jna&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;5.13.0&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div></li></ul></blockquote><p>1、首先下载模拟工具，可直接从<a href="http://pmp.hikvision.com.cn/#/SDK_VERSION/HCNetSDK" target="_blank" rel="noreferrer">组件工具</a><sup>PMP</sup>下载，或者直接附件中获取；</p><p><img src="`+g+`" alt="image-20240301112051121"></p><p>2、解压以后获取相关的SDK动态库文件，说明文档以及头文件等（<em>题外话：HCNetSDK.h有五万多行代码，具体数字是52731，我惊叹得差点裤衩子都掉了，当然也敬佩那些前辈们的辛勤付出</em>）；</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">📂HCNetSDKV6.</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">49_build20240117_Win64_ZH</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ├─ 📁ClientDemo </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//C++示例Demo程序源代码</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ├─ 📁doc </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//SDK使用手册</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ├─ 📁incCn </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//动态库.h头文件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    └─ 📁lib </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//dll动态库文件及依赖库</span></span></code></pre></div><p>3、进入<code>\\lib\\win64</code>目录运行<code>ClientDemo.exe</code>测试程序，保证该Demo工具在本机能够正常运行，即表示动态库文件没有问题；</p><p><img src="`+o+'" alt="image-20240301111115097"></p><h3 id="预览集成流程" tabindex="-1">预览集成流程 <a class="header-anchor" href="#预览集成流程" aria-label="Permalink to &quot;预览集成流程&quot;">​</a></h3><p>参考自“<a href="https://wiki.hikvision.com.cn/pages/viewpage.action?pageId=144948943" target="_blank" rel="noreferrer">预览录像抓图模块流程</a><sup>Wiki</sup>”，另外根据实际实现逻辑，重新组织流程节点。</p><p><img src="'+y+'" alt=""></p><h3 id="代码示例" tabindex="-1">代码示例 <a class="header-anchor" href="#代码示例" aria-label="Permalink to &quot;代码示例&quot;">​</a></h3><p>在进入代码章节之前，可以<strong>先预习一遍“设备网络SDK使用手册.chm”的&quot;Java开发指南&quot;章节</strong>，其中介绍了JNA工程创建，接口定义以及基础方法调用等示例，这些基础我在这儿将不再做赘述。</p><p><img src="'+c+`" alt="image-20240318162616544"></p><p>另外Java和C++之间调用的知识，可以参考“<a href="https://wiki.hikvision.com.cn/pages/viewpage.action?pageId=219174106" target="_blank" rel="noreferrer">记一次通过JNA调用C++接口的过程</a><sup>Wiki</sup>”分享，如果遇到了动态库调用的新问题，我会一直更新在这篇分享之中。</p><p>整个代码很简单（测试Demo工程可以从附件中获取），除了动态库接口，核心就两个类：<code>VideoPlayerWindow</code>和<code>VideoPlayer</code>。</p><p><code>VideoPlayerWindow</code>负责构建播放窗口，包括窗口大小，布局等等。整个窗口包括两个对象，一个<code>JFrame</code>窗口框架和一个用于视频加载区域的<code>Panel</code>。</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 视频播放窗口对象</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@author</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> yuanzp</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * @date 2024/3/10 14:29</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * @digression I&#39;ll try to do my best with it!</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> VideoPlayerWindow</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> JFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * 设置窗口宽度</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> WIDTH </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 960</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * 设置窗口高度</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HEIGHT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 540</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Panel videoArea </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Panel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> VideoPlayerWindow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        setTitle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;🌝视频预览&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 设置窗口标题</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 创建主容器并设置布局为BorderLayout</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Container container </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getContentPane</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        container.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setLayout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> BorderLayout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 添加视频显示区域到主容器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        container.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(videoArea);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 将视频显示区域设置为全屏模式</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        videoArea.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setPreferredSize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Dimension</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WIDTH, HEIGHT));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        videoArea.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setBackground</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Color.BLACK);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        pack</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 自动调整窗口大小以适应内部组件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        setDefaultCloseOperation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(EXIT_ON_CLOSE); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 关闭时结束程序运行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        setVisible</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 显示窗口</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><code>VideoPlayer</code>负责调用HCNetSDK动态库接口，实现初始化，登录，预览，关闭退出等等操作。</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 视频播放</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@author</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> yuanzp</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * @date 2024/3/15 14:29</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * @digression I&#39;ll try to do my best with it!</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> VideoPlayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    static</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HCNetSDKLibrary instance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HCNetSDKLibrary.INSTANCE;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * 用户登录返回句柄</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userID;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String ip, userName, password;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> port;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * 构造函数</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> ip</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> port</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> userName</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> password</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> VideoPlayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">userName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.ip </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ip;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.port </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> port;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.userName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userName;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.password </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> password;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * 播放</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> channel</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> play</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> channel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 初始化</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> initSuc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> instance.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NET_DVR_Init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (initSuc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;初始化失败&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 打印SDK日志</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        instance.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NET_DVR_SetLogToFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SDKLog</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 用户登陆操作</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        Login_V40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ip, (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">short</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) port, userName, password);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        RealPlay_V40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(channel);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * 预览</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> channel</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RealPlay_V40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> channel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        /*</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         *实现SDK中其余功能模快</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        NET_DVR_PREVIEWINFO netDvrPreviewinfo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NET_DVR_PREVIEWINFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        VideoPlayerWindow videoPlayerWindow </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> VideoPlayerWindow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 获取窗口句柄</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        WinDef.HWND hwnd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> WinDef.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HWND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Native.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getComponentPointer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(videoPlayerWindow.videoArea));</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        //创建窗口对象</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        netDvrPreviewinfo.hPlayWnd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hwnd;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        netDvrPreviewinfo.lChannel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> channel;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//预览通道号</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        netDvrPreviewinfo.dwStreamType </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//0-主码流，1-子码流，2-码流3，3-码流4，以此类推</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        netDvrPreviewinfo.dwLinkMode </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//0- TCP方式，1- UDP方式，2- 多播方式，3- RTP方式，4-RTP/RTSP，5-RSTP/HTTP</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        netDvrPreviewinfo.bBlocked </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//0- 非阻塞取流，1- 阻塞取流</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lRealPlayHandle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> instance.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NET_DVR_RealPlay_V40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userID, netDvrPreviewinfo, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (lRealPlayHandle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;NET_DVR_RealPlay_V40 error</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            Logout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;取流成功！&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        videoPlayerWindow.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addWindowListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WindowAdapter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> windowClosing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WindowEvent </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                //关闭预览</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                instance.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NET_DVR_StopRealPlay</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lRealPlayHandle);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                //用户注销，释放SDK</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                Logout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                super</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">windowClosing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * 登录</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> m_sDeviceIP</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 设备ip地址</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> wPort</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       端口号，设备网络SDK登录默认端口8000</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> m_sUsername</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 用户名</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> m_sPassword</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 密码</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Login_V40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">m_sDeviceIP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">short</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> wPort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">m_sUsername</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">m_sPassword</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        /* 注册 */</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 设备登录信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        NET_DVR_USER_LOGIN_INFO m_strLoginInfo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NET_DVR_USER_LOGIN_INFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 设备信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        NET_DVR_DEVICEINFO_V40 m_strDeviceInfo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NET_DVR_DEVICEINFO_V40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        System.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">arraycopy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m_sDeviceIP.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, m_strLoginInfo.sDeviceAddress, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, m_sDeviceIP.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        m_strLoginInfo.wPort </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wPort;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        System.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">arraycopy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m_sUsername.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, m_strLoginInfo.sUserName, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, m_sUsername.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        System.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">arraycopy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m_sPassword.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, m_strLoginInfo.sPassword, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, m_sPassword.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 是否异步登录：false- 否，true- 是</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        m_strLoginInfo.bUseAsynLogin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // write()调用后数据才写入到内存中</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        m_strLoginInfo.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        userID </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> instance.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NET_DVR_Login_V40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m_strLoginInfo, m_strDeviceInfo);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (userID </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;登录失败，错误码为&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> instance.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NET_DVR_GetLastError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;登录成功！&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // read()后，结构体中才有对应的数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            m_strDeviceInfo.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">read</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * 设备注销 SDK释放</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Logout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (userID </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (instance.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NET_DVR_Logout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userID) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;注销失败，错误码为&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> instance.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NET_DVR_GetLastError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;注销成功！&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            instance.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NET_DVR_Cleanup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;设备未登录！&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            instance.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NET_DVR_Cleanup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(log);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>最后运行<code>Main</code>函数即可加载出视频预览窗口。</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * Man函数</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@author</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> yuanzp</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * @date 2024/3/1 14:29</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * @digression I&#39;ll try to do my best with it!</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">throws</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> InterruptedException {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        //play多次，多窗口模式下，预览没有问题，但是一个窗口关闭即会触发全部窗口关闭。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        VideoPlayer videoPlayer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> VideoPlayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;10.21.82.250&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;admin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Abc12345&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        videoPlayer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">play</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><img src="`+D+'" alt="image-20240315172054169"></p><h2 id="🥯-参考资料" tabindex="-1">🥯 参考资料 <a class="header-anchor" href="#🥯-参考资料" aria-label="Permalink to &quot;🥯 参考资料&quot;">​</a></h2><ul><li><a href="http://stt.hiktest.com/mindoc/docs/hice/hice-1cdn2dsgs7v60" target="_blank" rel="noreferrer">视频基础知识</a><sup>嗨学</sup></li><li><a href="https://wiki.hikvision.com.cn/pages/viewpage.action?pageId=185436085" target="_blank" rel="noreferrer">视频流基础知识总结分享</a><sup>Wiki</sup></li><li><a href="https://hls.hikvision.com/#/courseDetail?lessonCode=2023030800101&amp;lessonId=24449&amp;t=1" target="_blank" rel="noreferrer">视频云存储异构方案介绍</a><sup>嗨学</sup></li><li><a href="https://wiki.hikvision.com.cn/display/HWSY/3.4.5.1.3+HCNetSDK" target="_blank" rel="noreferrer">HCNetSDK集成资料</a><sup>Wiki</sup></li><li>设备网络SDK使用手册.chm<sup>CHM</sup></li><li>视频基础知识介绍.pptx<sup>PPT</sup></li></ul><h2 id="🍖-特别感谢" tabindex="-1">🍖 特别感谢 <a class="header-anchor" href="#🍖-特别感谢" aria-label="Permalink to &quot;🍖 特别感谢&quot;">​</a></h2><ul><li>特别感谢<strong>童工（童彬彬）</strong>，解答了若干媒体取流方面的疑问；</li><li>感谢<strong>梅工（梅文龙）</strong>，共享给我视频基础知识介绍的PPT文件，帮助了解学习了视频基础；</li></ul><h2 id="🌙-写在最后面的话" tabindex="-1">🌙 写在最后面的话 <a class="header-anchor" href="#🌙-写在最后面的话" aria-label="Permalink to &quot;🌙 写在最后面的话&quot;">​</a></h2><p>嗯，有点累。</p><p>工作顺利，盆友~<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup></p><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>基于设备私有网络通信协议开发的，为嵌入式网络硬盘录像机、NVR、网络摄像机、网络球机、视频服务器、解码器、报警主机、网络存储等产品服务的配套模块，用于远程访问和控制设备软件的二次开发。 <a href="#fnref1" class="footnote-backref">↩︎</a></p></li><li id="fn2" class="footnote-item"><p>“林中的路分成两条，我选择了较少人涉足的一条，一切差别由此而来。”---created by 袁志鹏 on 一月 8,2024 edited by 袁志鹏 on 三月 18,2024 <a href="#fnref2" class="footnote-backref">↩︎</a></p></li></ol></section>',139),C=[A];function u(B,m,_,b,f,v){return a(),i("div",null,C)}const S=s(F,[["render",u]]);export{q as __pageData,S as default};
